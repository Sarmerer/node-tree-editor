(function(t){function e(e){for(var o,r,a=e[0],d=e[1],l=e[2],u=0,h=[];u<a.length;u++)r=a[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&h.push(n[r][0]),n[r]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(t[o]=d[o]);c&&c(e);while(h.length)h.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],o=!0,a=1;a<i.length;a++){var d=i[a];0!==n[d]&&(o=!1)}o&&(s.splice(e--,1),t=r(r.s=i[0]))}return t}var o={},n={app:0},s=[];function r(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=o,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(i,o,function(e){return t[e]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-mindmap/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],d=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var c=d;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0ac6":function(t,e,i){"use strict";i("cf97")},"0bfd":function(t,e,i){"use strict";i("3835")},"17a8":function(t,e,i){},"24f4":function(t,e,i){"use strict";i("8ded")},3835:function(t,e,i){},4580:function(t,e,i){"use strict";i("e095")},"542c":function(t,e,i){},"543a":function(t,e,i){"use strict";i("be11")},"54a9":function(t,e,i){"use strict";i("5a7f")},"56d7":function(t,e,i){"use strict";i.r(e);var o=i("2b0e"),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.tree.loaded?e("tree"):t._e()],1)},s=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e("context-menu",{ref:"contextMenu",scopedSlots:t._u([{key:"items",fn:function(){return[e("button",{staticClass:"context-menu-item",on:{click:t.addSibling}},[e("b-icon",{attrs:{icon:"node-plus"}}),t._v(" Add sibling ")],1),e("button",{staticClass:"context-menu-item",on:{click:t.addChild}},[e("b-icon",{attrs:{icon:"diagram2"}}),t._v(" Add child ")],1),e("button",{staticClass:"context-menu-item",on:{click:t.toggleDone}},[e("b-icon",{attrs:{icon:t.tree.lastNode.done?"x":"check2"}}),t._v(" "+t._s(t.tree.lastNode.done?"Undo":"Done")+" ")],1),t.tree.lastNode.isRoot?t._e():e("button",{staticClass:"context-menu-item",on:{click:t.pushRootToQuery}},[e("b-icon",{attrs:{icon:"arrow-bar-down"}}),t._v(" Drill down ")],1),t.tree.lastNode.childrenLength?e("button",{staticClass:"context-menu-item",on:{click:t.collapseLastNode}},[e("b-icon",{attrs:{icon:t.tree.lastNode.collapsed?"arrows-expand":"arrows-collapse"}}),t._v(" "+t._s(t.tree.lastNode.collapsed?"Expand":"Collapse")+" ")],1):t._e(),e("button",{staticClass:"context-menu-item",on:{click:t.editLastNode}},[e("b-icon",{attrs:{icon:"pencil"}}),t._v(" Edit ")],1),e("button",{staticClass:"context-menu-selector"},[e("b-icon",{attrs:{icon:"kanban"}}),t._v(" Weight: "+t._s(t.tree.lastNode.weight||1)+" "),e("ul",t._l(["Default",10,5,1,-1,-5,-10],(function(i,o){return e("li",{key:o,on:{click:function(e){return t.tree.lastNode.addWeight(i)}}},[t._v(" "+t._s(i>=0?"+"+i:i)+" ")])})),0),e("b-icon",{staticClass:"arrow",attrs:{icon:"chevron-right"}})],1),e("button",{staticClass:"context-menu-selector"},[e("b-icon",{attrs:{icon:"gear"}}),t._v(" Settings "),e("ul",t._l(t.tree.lastNode.settings,(function(i,o){return e("li",{key:o,on:{click:function(e){return t.tree.lastNode.toggleSetting(o)}}},[t._v(" "+t._s(o)+" "),i?e("b-icon",{attrs:{icon:"check2"}}):t._e()],1)})),0),e("b-icon",{staticClass:"arrow",attrs:{icon:"chevron-right"}})],1),t.tree.lastNode.deletable?e("button",{staticClass:"context-menu-item",on:{click:t.deleteLastNode}},[e("b-icon",{attrs:{icon:"node-minus"}}),t._v(" Delete ")],1):t._e()]},proxy:!0}])}),e("toolbar"),e("div",{ref:"container",staticClass:"tree-container",class:{dragging:t.nodeDrag.dragging},on:{mousewheel:t.handleZoom,mouseup:function(e){return"button"in e&&1!==e.button?null:t.handleZoom.apply(null,arguments)}}},[e("svg",{ref:"svg",staticClass:"svg vue-tree",style:t.initialTransformStyle}),e("div",{ref:"domContainer",staticClass:"dom-container",style:t.initialTransformStyle},t._l(t.nodeDataList,(function(i){return e("div",{key:i.data._key,staticClass:"node-slot",style:{left:t.formatDimension(i.y),top:t.formatDimension(i.x),width:t.formatDimension(t.config.nodeWidth),height:t.formatDimension(t.config.nodeHeight)},on:{dragover:function(e){return e.stopPropagation(),t.mouseOverNode(e,i)},dragend:function(e){return t.onDrop(e,i)}}},[e("div",{staticClass:"node-slot-overlay",class:{"node-top":"top"===t.nodeDrag.snap&&t.isDraggedOver(i.data),"node-bottom":"bottom"===t.nodeDrag.snap&&t.isDraggedOver(i.data),"node-right":"right"===t.nodeDrag.snap&&t.isDraggedOver(i.data)}},[e("div",{staticClass:"node",class:{dragover:t.isDraggedOver(i.data),highlighted:i.data._gid===t.tree.lastNode._gid,stack:i.data.childrenLength&&i.data.collapsed,done:i.data.done,editing:i.data.editing},style:{"max-width":t.formatDimension(t.config.nodeMaxWidth),"max-height":t.formatDimension(t.config.nodeMaxHeight)},attrs:{draggable:i.data.draggable},on:{mousedown:function(t){t.stopPropagation()},click:function(e){return t.setLastNode(i.data,e)},contextmenu:function(e){return t.nodeContextClick(e,i.data)},dragstart:function(e){return t.startDrag(e,i)},drag:function(e){return t.onDrag()}}},[i.data.editing?t._e():e("div",{staticClass:"content"},[!i.data.editing&&i.data.emoji&&i.data.emoji.length?e("div",t._l(t.emojifyArray(i.data.emoji),(function(i,o){return e("span",{key:o},[t._v(t._s(i)+" ")])})),0):t._e(),i.data.editing?t._e():e("pre",{domProps:{textContent:t._s(i.data.name)},on:{mousewheel:function(t){t.stopPropagation()}}}),i.data.isRoot&&t.tree.hasQuery?e("button",{staticClass:"drill-up",on:{click:function(e){return e.stopPropagation(),t.spliceRootsQuery.apply(null,arguments)}}},[e("b-icon",{attrs:{icon:"arrow-bar-up"}})],1):t._e()]),i.data.editing?e("textarea",{directives:[{name:"model",rawName:"v-model",value:i.data._name,expression:"node.data._name"}],ref:"node-#"+i.data._gid,refInFor:!0,domProps:{value:i.data._name},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.quitNodeEditor.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.quitNodeEditor(e,{save:!0}))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.preventDefault(),t.quitNodeEditor(e,{save:!0,callback:t.addChild}))},function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;t.stopPropagation()}],blur:function(e){return t.blurLastNode(i.data)},mousewheel:function(t){t.stopPropagation()},input:function(e){e.target.composing||t.$set(i.data,"_name",e.target.value)}}}):t._e(),!i.data.editing&&i.data.totalChildrenTasks>0?e("sub",{staticClass:"completeness"},[t._v(t._s(`${i.data.finishedChildrenTasks}/${i.data.totalChildrenTasks}`))]):t._e(),t.shouldDisplayProgress(i.data)?e("div",{staticClass:"progress",class:{"round-right":100==i.data.progress},style:{width:i.data.progress+"%"},attrs:{title:i.data.progress+"%"}}):t._e(),i.data._gid===t.tree.lastNode._gid?e("div",{staticClass:"controls"},[e("button",{staticClass:"add-child",on:{click:function(e){return e.stopPropagation(),t.addSibling.apply(null,arguments)}}},[e("b-icon",{attrs:{icon:"node-plus"}})],1),e("button",{staticClass:"add-sibling",on:{click:t.addChild}},[e("b-icon",{attrs:{icon:"diagram2"}})],1)]):t._e()])])])})),0)]),e("breadcrumb"),e("cards-wrapper")],1)},a=[],d=(i("14d9"),function(){var t=this,e=t._self._c;return e("div",[e("modal",{attrs:{name:"info-modal",adaptive:!0,height:"auto",width:"500px"}},[e("div",{attrs:{id:"modal"}},[e("table",{staticClass:"info-table"},t._l(t.events,(function(i,o){return e("tr",{key:o,staticClass:"info-row"},[e("td",{staticClass:"info-col-action"},[t._v(" "+t._s(i.title)+" ")]),e("td",{staticClass:"info-col-hotkey"},[t._v(" "+t._s(i.hotkey.join(" / "))+" ")])])})),0)])]),e("documents-list"),e("import-export-modal",{attrs:{tab:"f"}}),e("div",{staticClass:"toolbar"},[e("div",{staticClass:"left-buttons"},t._l(t.actions,(function(i,o){return e("div",{key:o,attrs:{title:i.title}},[t.condSatisfied(i)?e("button",{on:{click:function(e){return e.stopPropagation(),t.emitEvent(i.event)}}},[e("b-icon",{attrs:{icon:i.icon}})],1):t._e()])})),0),e("div",{staticClass:"right-buttons"},[e("button",{attrs:{title:"Delete All Cards"},on:{click:t.deleteAllCards}},[e("b-icon",{attrs:{icon:"x"}})],1),e("button",{attrs:{title:"New Card"},on:{click:t.spawnCard}},[e("b-icon",{attrs:{icon:"file-post"}})],1),e("button",{staticClass:"doc-export",attrs:{title:"Export"},on:{click:function(e){return t.toggleImportExportModal("export")}}},[e("b-icon",{attrs:{icon:"upload"}})],1),e("button",{staticClass:"doc-import",attrs:{title:"Import"},on:{click:function(e){return t.toggleImportExportModal("import")}}},[e("b-icon",{attrs:{icon:"download"}})],1),e("button",{attrs:{title:"Documents"},on:{click:function(e){return e.stopPropagation(),t.toggleDocMenu.apply(null,arguments)}}},[e("b-icon",{attrs:{icon:"file-earmark-text"}})],1),e("button",{attrs:{title:"Emoji"},on:{click:t.toggleEmojiBar}},[e("b-icon",{attrs:{icon:"emoji-smile"}})],1),e("button",{attrs:{title:"Help"},on:{click:function(e){return t.$modal.show("info-modal")}}},[e("b-icon",{attrs:{icon:"question"}})],1)])]),e("emoji-bar",{ref:"emojiBar",staticClass:"emoji-bar"})],1)}),l=[],c=function(){var t=this,e=t._self._c;return e("modal",{staticClass:"helper",attrs:{name:"import-export-modal",adaptive:!0,height:"auto",width:"30%"},on:{"before-open":t.beforeOpen}},["import"===t.currTab?e("import-JSON"):e("export-JSON")],1)},u=[],h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e("tabs",[e("tab",{attrs:{name:"Import From File"}},[e("div",{staticClass:"import-tab"},[e("div",{staticClass:"checkbox",class:{checked:t.importToSelectedNode}},[e("label",{staticClass:"checkbox-label",attrs:{for:"import-to-selected-from-file"}},[t._v("Import to selected node")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.importToSelectedNode,expression:"importToSelectedNode"}],attrs:{type:"checkbox",id:"import-to-selected-from-file"},domProps:{checked:Array.isArray(t.importToSelectedNode)?t._i(t.importToSelectedNode,null)>-1:t.importToSelectedNode},on:{change:function(e){var i=t.importToSelectedNode,o=e.target,n=!!o.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);o.checked?r<0&&(t.importToSelectedNode=i.concat([s])):r>-1&&(t.importToSelectedNode=i.slice(0,r).concat(i.slice(r+1)))}else t.importToSelectedNode=n}}})]),e("span",[e("input",{ref:"file",attrs:{type:"file"},on:{change:t.fileChange}})]),e("div",{staticClass:"import-button"},[e("button",{on:{click:t.importFromFile}},[t._v("Import")])])])]),e("tab",{attrs:{name:"Import From Clipboard"}},[e("div",{staticClass:"import-tab"},[e("small",[t._v("This feature requires Clipboard permission and doesn't work if it's not granted")]),e("div",{staticClass:"checkbox",class:{checked:t.importToSelectedNode}},[e("label",{staticClass:"checkbox-label",attrs:{for:"import-to-selected-from-clipboard"}},[t._v("Import to current node")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.importToSelectedNode,expression:"importToSelectedNode"}],attrs:{type:"checkbox",id:"import-to-selected-from-clipboard"},domProps:{checked:Array.isArray(t.importToSelectedNode)?t._i(t.importToSelectedNode,null)>-1:t.importToSelectedNode},on:{change:function(e){var i=t.importToSelectedNode,o=e.target,n=!!o.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);o.checked?r<0&&(t.importToSelectedNode=i.concat([s])):r>-1&&(t.importToSelectedNode=i.slice(0,r).concat(i.slice(r+1)))}else t.importToSelectedNode=n}}})]),e("div",{staticClass:"import-button"},[e("button",{on:{click:t.importFromClipboard}},[t._v("Import")])])])])],1)],1)},p=[],g=i("5502"),m=i("0e44");i("907a"),i("986a"),i("1d02"),i("3c5d");function f(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}class v{constructor(t="",e="",i={editing:!1,x:0,y:0,group:void 0,dragging:!1}){this.id=f(),this.x=i.x||0,this.y=i.y||0,this.text=t,this.icon=e,this.editing=i.editing||!1,this.group=i.group||null,this.dragging=i.dragging||!1,this.focused=!1,this.noPointerEvents=!1,this.orderInGroup=0}get isChild(){return!!this.group}}o["default"].use(g["a"]);class b{constructor(t,e){this.name=t,this.data=e,this.lastEdit=Date.now()}}const _=new g["a"].Store({state:{favoriteEmojis:[],settings:{lastDocument:""},cards:[],cardGroups:[],documents:{}},plugins:[Object(m["a"])()],mutations:{addFavoriteEmoji:function(t,e){return t.favoriteEmojis.push(e)},removeFavoriteEmoji:function(t,e){return t.favoriteEmojis.splice(t.favoriteEmojis.indexOf(e),1)},setDocument:function(t,e){e&&(t.settings.lastDocument=e)},updateDocument:(t,{uuid:e,data:i})=>{Object.assign(t.documents[e],i)},addDocument:(t,{uuid:e,document:i})=>{t.documents[e]=i},addCard:function(t,e){e instanceof v&&t.cards.push(e)},addCardToGroup:function(t,{cardID:e,groupID:i}){const o=t.cards.findIndex(t=>t.id===e);if(o<0)return;t.cards[o].group=i;const n=t.cards.filter(t=>t.group===i)||[];t.cards[o].orderInGroup=n>0?n+1:0},setCardOrder:function(t,{cardID:e,newIndex:i}){const o=t.cards.findIndex(t=>t.id===e);o<0||(t.cards[o].orderInGroup=i)},updateCards:function(t,e){t.cards=e},deleteCard:function(t,e){const i=t.cards.findIndex(t=>t.id===e);i<0||t.cards.splice(i,1)},deleteCardsInGroup:function(t,e){const i=t.cards.map((t,i)=>t.group===e?i:void 0).filter(t=>void 0!==t);if(i.length)for(var o=i.length-1;o>=0;o--)t.cards.splice([i[o]],1)},deleteAllCards:function(t){t.cardGroups=[],t.cards=[]},createGroup:function(t,e){t.cardGroups.push(e)},setCardProperty:function(t,{cardID:e,key:i,value:o,keyValues:n}){const s=t.cards.findIndex(t=>t.id===e);if(!(s<0)&&(t.cards[s][i]=o,n&&Array.isArray(n)))for(let a of n)"object"!==typeof a||r(a.key)||(t.cards[s][a.key],a.value);function r(t){return void 0===t||null===t}},reorderGroup:function(t,{groupID:e,priorityIndex:i,priorityID:o}){const n=t.cards.filter(t=>t.group===e).sort((t,e)=>t.orderInGroup-e.orderInGroup),s=n.findIndex(t=>t.id===o);if(!(s<0)){n.splice(i,0,n.splice(s,1)[0]);for(let t=0;t<n.length;t++)t===i&&n[t].id===o||(n[t].orderInGroup=t)}},deleteGroup:function(t,e){const i=t.cardGroups.findIndex(t=>t.id===e);i<0||t.cardGroups.splice(i,1)}},actions:{getTreeData:({state:t,dispatch:e})=>t.settings.lastDocument&&t.documents[t.settings.lastDocument]?t.documents[t.settings.lastDocument].data:e("createDocument"),createDocument:({commit:t,state:e},i={name:"document",data:{}})=>{const o=f();return t("addDocument",{uuid:o,document:new b(i.name,i.data)}),t("setDocument",o),e.documents[o].data},setDocument:({commit:t,state:e},i)=>(i&&t("setDocument",i),e.documents[i].data),saveDocument:({commit:t,state:e,getters:i},o)=>{i.lastDocExists&&t("updateDocument",{uuid:e.settings.lastDocument,data:{lastEdit:Date.now(),data:o}})},deleteDocument:({commit:t,state:e,dispatch:i},n)=>{o["default"].delete(e.documents,n);const s=Object.keys(e.documents);return s.length?(t("setDocument",s[0]),e.documents[s[0]].data):i("createDocument")},changeCardPosition:({commit:t},{cardID:e,groupID:i,newIndex:o})=>{t("setCardOrder",{cardID:e,newIndex:o}),t("reorderGroup",{groupID:i,priorityIndex:o,priorityID:e})},addCardToGroup:({commit:t},{cardID:e,groupID:i})=>{t("addCardToGroup",{cardID:e,groupID:i}),t("reorderGroup",{groupID:i})},deleteGroup:({commit:t},e)=>{t("deleteGroup",e),t("deleteCardsInGroup",e)}},getters:{documents:t=>t.documents,treeData:function(t){return t.settings.lastDocument&&t.documents[t.settings.lastDocument]?t.documents[t.settings.lastDocument].data:{}},cards:t=>t.cards.filter(t=>!t.group),groups:(t,e)=>[...new Set(e.groupedCards.map(t=>t.group))],groupedCards:t=>t.cards.filter(t=>"string"===typeof t.group),lastDocExists:t=>!!t.documents[t.settings.lastDocument]}});i("13d5");const y={displayProgress:!0,deepProgress:!0};class x{constructor(t=0,e=0,i=null,o=0,n={name:"",firstEdit:!0,collapsed:!1,children:[],emoji:[],done:!1,isRoot:!1,weight:1,virtualChildren:0,virtualFinishedChildren:0,settings:{displayProgress:!0,deepProgress:!0}}){var s,r;this._gid=t,this._id=e,this._name=n.name,this._parentNode=i,this._children=n.children,this._collapsed=!0===(null===n||void 0===n?void 0:n.collapsed),this._depth=o,this._editing=!!n.firstEdit&&null!==i,this._firstEdit=n.firstEdit,this._emoji=n.emoji||[],this._done=n.done,this._weight=n.weight||1,this._virtualChildrenAmount=n.virtualChildren||0,this._virtualFinishedChildrenAmount=n.virtualFinishedChildren||0,this.isRoot=!0===(null===n||void 0===n?void 0:n.isRoot),this.size=[250,250],this._settings={displayProgress:!1!==(null===(s=n.settings)||void 0===s?void 0:s.displayProgress),deepProgress:!1!==(null===(r=n.settings)||void 0===r?void 0:r.deepProgress)}}addChild(t){t instanceof x&&this._children.push(t)}addChildAtIndex(t,e){t instanceof x&&!(e<0)&&this._children.splice(e,0,t)}toggleEmoji(t){this._emoji.includes(t)?this._emoji.splice(this._emoji.indexOf(t),1):this._emoji.push(t)}toggleDoneState(){this._done=!this._done}getChildren(){return this._children}setAllChildrenDoneState(t){this._children.forEach(e=>e.done=!!t)}delete(){const t=this._parentNode._children.indexOf(this);this._parentNode.children.splice(t,1)}setSetting(t,e){void 0!==this._settings[t]&&(this._settings[t]=e)}toggleSetting(t){void 0!==this._settings[t]&&"boolean"===typeof this._settings[t]&&this.setSetting(t,!this._settings[t])}parseName(){this._name=this._name.trim();const t=this._name.match(/\s\d+$/gm),e=this._name.match(/\s\d+\/\d+/gm);if(null!==t&&void 0!==t&&t.length)this._weight=parseInt(t[0]),this._virtualChildrenAmount=0,this._virtualFinishedChildrenAmount=0;else if(null!==e&&void 0!==e&&e.length){const t=e[0].split("/");if(2===t.length){const e=parseInt(t[0]),i=parseInt(t[1]);e<=i&&(this._virtualFinishedChildrenAmount=e,this._virtualChildrenAmount=i)}this._name=this._name.slice(0,-e[0].length)}}export(){return t(this);function t(i){var o;const n={name:i.name,children:null!==(o=i.getChildren())&&void 0!==o&&o.length?i.getChildren().map(i=>{if(i.getChildren().length)return t(i);{const t={name:i.name};return e(t,i),t}}):[]};return e(n,i),n}function e(t,e){var i;e.collapsed&&(t.collapsed=!0),e.done&&(t.done=!0),null!==(i=e.emoji)&&void 0!==i&&i.length&&(t.emoji=e.emoji),e.weight>1&&(t.weight=e.weight),e._virtualChildrenAmount>0&&(t.virtualChildren=e._virtualChildrenAmount),e._virtualFinishedChildrenAmount>0&&(t.virtualFinishedChildren=e._virtualFinishedChildrenAmount),JSON.stringify(e.settings)!==JSON.stringify(y)&&(t.settings={},Object.entries(e.settings).forEach(([e,i])=>{i!==y[e]&&(t.settings[e]=i)}))}}addWeight(t){"number"===typeof t&&this._weight+t>0?this._weight+=t:this._weight=1}get id(){return this._id}get parent(){return this._parentNode}get children(){return this.collapsed?[]:this._children}get collapsed(){return this._collapsed}get name(){return this._name||"node #"+this._gid}get editing(){return this._editing}get depth(){return this._depth}get childrenLength(){return this._children.length}get totalChildrenTasks(){if(this._virtualChildrenAmount>0)return this._virtualChildrenAmount;let t=0;return this._children.forEach(e=>{t+=1,e._virtualChildrenAmount>0?t+=e._virtualChildrenAmount:e._children.length&&(t+=e.totalChildrenTasks)}),t}get finishedChildrenTasks(){if(this._virtualFinishedChildrenAmount>0)return this._virtualFinishedChildrenAmount;if(this._children.length){let t=0;return this._children.forEach(e=>{t+=e.done?1:0,e._virtualFinishedChildrenAmount>0?t+=e._virtualFinishedChildrenAmount:e._children.length&&(t+=e.finishedChildrenTasks)}),t}return 0}get firstEdit(){return this._firstEdit}get emoji(){return this._emoji}get done(){return this._done}get progress(){const{percentage:t}=this._settings.deepProgress?this.deepProgress:this.shallowProgress;return t}get deepProgress(){if(this._virtualFinishedChildrenAmount>0){const t=this._virtualFinishedChildrenAmount,e=this._virtualChildrenAmount,i=(t/e*100).toFixed(0);return{sum:t,totalNodes:e,percentage:i}}if(this._children.length){let t=0,e=this._children.reduce((t,e)=>t+(e.weight||1),0);return this._children.forEach(i=>{if(t+=i.done?i.weight||1:0,i._virtualChildrenAmount>0)t+=i._virtualFinishedChildrenAmount,e+=i._virtualChildrenAmount;else if(i._children.length){let{sum:o,totalNodes:n}=i.deepProgress;t+=o,e+=n}}),{sum:t,totalNodes:e,percentage:(t/e*100).toFixed(0)}}return{sum:0,totalNodes:0,percentage:0}}get shallowProgress(){if(this._virtualFinishedChildrenAmount>0){const t=this._virtualFinishedChildrenAmount,e=this._virtualChildrenAmount,i=(t/e*100).toFixed(0);return{sum:t,totalNodes:e,percentage:i}}if(this._children.length){let t=0,e=this._children.reduce((t,e)=>t+(e.weight||1),0);return this._children.forEach(e=>t+=e.done?e.weight||1:0),{sum:t,totalNodes:e,percentage:(t/e*100).toFixed(0)}}return{sum:0,totalNodes:0,percentage:0}}get settings(){return this._settings}get canDrillDown(){return!this.isRoot}get canDrillUp(){return this.isRoot&&null!=this._parentNode}get collapsible(){return!this._collapsed&&this.childrenLength>0}get expandable(){return this._collapsed}get draggable(){return!this.isRoot}get deletable(){return!this.isRoot}get weight(){return this._weight}set id(t){this._id=t}set name(t){this._name=t,this.editing=!1}set editing(t){this._editing=t,this._firstEdit&&!1===t&&(this._firstEdit=!1)}set collapsed(t){this._children.length&&(this._collapsed=t)}set children(t){this._children=t}set parent(t){this._parentNode=t}set done(t){this._done=!!t}set weight(t){"number"===typeof t&&(this._weight=t)}}class C{constructor(){this._gidCounter=1,this._root=new x(0,0,null,0,{name:"root",isRoot:!0}),this.lastNode=this._root,this._query=[],this.loaded=!1,_.dispatch("getTreeData").then(t=>{this.parseTreeData(t),this.loaded=!0})}addSibling(){const t=this.createNode(this.lastNodeID,this.lastNodeParent?this.lastNodeParent:this._root,this._lastNode.depth||1);this.lastNodeParent?this.pushNode(this.lastNodeParent.children,t):this.pushNode(this._root.children,t),this.lastNode=t}addChild(){const t=this._lastNode?this._lastNode.children.length:this.lastNodeID,e=this.createNode(t,this._lastNode,(this._lastNode.depth||0)+1);this._lastNode?this.pushNode(this._lastNode.children,e):this.pushNode(this._root,e),this.lastNode=e,this.lastNodeParent.collapsed=!1}pushNode(t,e){t.push(e)}createNode(t=0,e=null,i){return new x(this.counter,t,e,i)}deleteLastNode(t={force:!1}){var e,i;if((this._lastNode.editing||!this.lastNodeParent)&&!t.force)return;let o=null;o=this._lastNode.id-1>=0?this.lastNodeParent.children[this._lastNode.id-1]:null!==(e=this.lastNodeParent)&&void 0!==e&&null!==(i=e.parent)&&void 0!==i&&i.children?this.lastNodeParent.parent.children[this.lastNodeParent.parent.children.length-1]:this.lastNodeParent,this.lastNodeParent.children.splice(this._lastNode.id,1),this.lastNode=o}collapseLastNode(){this._lastNode.editing||(this._lastNode.collapsed=!this._lastNode.collapsed)}blurLastNode(t){t&&this._lastNode._gid===t._gid&&(this._lastNode._firstEdit?this.deleteLastNode({force:!0}):this._lastNode.editing=!1)}goUp(){var t;if(!this._lastNode.editing)if(this._lastNode.id-1>=0)this.lastNode=this.lastNodeParent.children[this._lastNode.id-1];else if((null===(t=this.lastNodeParent)||void 0===t?void 0:t.id)>0&&this.lastNodeParent.parent){let t;for(let e=this.lastNodeParent.id-1;e>=0;e--)if(this.lastNodeParent.parent.children[e].children.length){t=this.lastNodeParent.parent.children[e];break}t&&(this.lastNode=t.children[t.children.length-1])}}goDown(){if(!this._lastNode.editing&&this.lastNodeParent)if(this._lastNode.id+1<this.lastNodeParent.children.length)this.lastNode=this.lastNodeParent.children[this._lastNode.id+1];else if(this.lastNodeParent.parent&&this.lastNodeParent.id<this.lastNodeParent.parent.children.length){let t;for(let e=this.lastNodeParent.id+1;e<this.lastNodeParent.parent.children.length;e++)if(this.lastNodeParent.parent.children[e].children.length){t=this.lastNodeParent.parent.children[e];break}t&&(this.lastNode=t.children[0])}}goLeft(){var t,e;this._lastNode.editing||null!==(t=this._lastNode)&&void 0!==t&&null!==(e=t.parent)&&void 0!==e&&e.parent&&(this.lastNode=this._lastNode.parent)}goRight(){if(this._lastNode.editing)return;if(!this._lastNode||!this._lastNode.children.length)return;let t=Math.floor(this._lastNode.children.length/2);this.lastNode=this._lastNode.children[t]}getChildren(){return this._root._children}cloneNode(t,e,i){const o=this;function n(t,e){const i=new x(o.counter,t.id,e,t.depth,w(t));return i.children=t.getChildren().map(t=>n(t,i)),i}const s=n(t,"bottom"===i||"top"===i?e.parent:e);if(t.delete(),i&&"right"!==i)if(i&&"top"!==i){if(i&&"bottom"!==i)return;e.parent.addChildAtIndex(s,e.parent._children.indexOf(e)+1)}else e.parent.addChildAtIndex(s,e.parent._children.indexOf(e));else e.addChild(s);this.lastNode=s}export(){const t=this._query.length?this._query[0]:this._root;return t.export()}import(t){var e;if(null===t||void 0===t||null===(e=t.children)||void 0===e||!e.length)return;const i=this;for(let s of t.children)o(s,this.lastNode);function o(t,e){var o;let s=new x(i.counter,e.children.length,e,e.depth+1||0,w(t));s.children=null!==(o=t.children)&&void 0!==o&&o.length?n(t,s):[],e.children.push(s)}function n(t,e){var o;return null===t||void 0===t||null===(o=t.children)||void 0===o?void 0:o.map((t,o)=>{var s;let r=new x(i.counter,o,e,e.depth+1,w(t));return r.children=null!==(s=t.children)&&void 0!==s&&s.length?n(t,r):[],r})}}parseTreeData(t){if(!t)return;const e=this;if(this._root.name=t.name?t.name:"root",this._root.children=[],this._lastNode=this._root,this._gidCounter=1,t.children)for(let n of t.children)i(n,this._root);function i(t,i){var n;let s=new x(e.counter,i.children.length,i,i.depth+1||0,w(t));s.children=null!==(n=t.children)&&void 0!==n&&n.length?o(t,s):[],i.children.push(s)}function o(t,i){var n;return null===t||void 0===t||null===(n=t.children)||void 0===n?void 0:n.map((t,n)=>{var s;let r=new x(e.counter,n,i,i.depth+1,w(t));return r.children=null!==(s=t.children)&&void 0!==s&&s.length?o(t,r):[],r})}}spliceRootsQuery(t){if(t<=0||t>this._query.length)return;t>1&&(this._query=this._query.slice(0,-(t-1)));const e=this._query.pop();this._root.isRoot=!1,e.isRoot=!0,this._root=e}pushRootToQuery(t){t&&t instanceof x&&(this._query.push(this._root),t.collapsed=!1,this._root.isRoot=!1,t.isRoot=!0,this._root=t)}sortLastNode(t,e){console.log(t,e),this.lastNode._children.sort((t,e)=>t.name<e.name?-1:1)}get lastNodeID(){return this.lastNodeParent?this.lastNodeParent.children.length:this._root.children.length}get lastNode(){return this._lastNode}get lastNodeParent(){var t;return(null===(t=this._lastNode)||void 0===t?void 0:t.parent)||null}get counter(){return this._gidCounter++}get root(){return this._root}get query(){return this._query}get hasQuery(){var t;return(null===(t=this._query)||void 0===t?void 0:t.length)>0}set lastNode(t){var e;if(!(t instanceof x))return null!==t&&void 0!==t&&t._root?null:console.error(t+" is not instance of Node");this._lastNode!==t&&(null!==this&&void 0!==this&&null!==(e=this._lastNode)&&void 0!==e&&e.editing&&(this._lastNode.editing=!1),this._lastNode=t)}}function w(t){return Object.assign({},{name:t.name,firstEdit:t.firstEdit||!1,collapsed:t.collapsed||!1,emoji:t.emoji,done:t.done,weight:t.weight||1,virtualChildren:t.virtualChildren,virtualFinishedChildren:t.virtualFinishedChildren,settings:t.settings})}const N=new C;var k=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tabs-component"},[e("ul",{staticClass:"tabs-component-tabs",attrs:{role:"tablist"}},t._l(t.tabs,(function(i,o){return e("li",{directives:[{name:"show",rawName:"v-show",value:i.isVisible,expression:"tab.isVisible"}],key:o,staticClass:"tabs-component-tab",class:{active:i.isActive,disabled:i.isDisabled},attrs:{role:"presentation"},on:{click:function(e){return t.selectTab(i.hash,e)}}},[e("span",{staticClass:"tabs-component-tab-a",attrs:{"aria-controls":i.hash,"aria-selected":i.isActive,href:i.hash,role:"tab"},domProps:{innerHTML:t._s(i.header)}})])})),0),e("div",{staticClass:"tabs-component-panels"},[t._t("default")],2)])},D=[],T={props:{cacheLifetime:{default:5},options:{type:Object,required:!1,default:()=>({useUrlFragment:!0,defaultTabHash:null})}},data:()=>({tabs:[],activeTabHash:"",activeTabIndex:0,lastActiveTabHash:""}),computed:{storageKey(){return`vue-tabs-component.cache.${window.location.host}${window.location.pathname}`}},created(){this.tabs=this.$children},mounted(){if(window.addEventListener("hashchange",()=>this.selectTab(window.location.hash)),this.findTab(window.location.hash))return void this.selectTab(window.location.hash);const t="";this.findTab(t)?this.selectTab(t):null!==this.options.defaultTabHash&&this.findTab("#"+this.options.defaultTabHash)?this.selectTab("#"+this.options.defaultTabHash):this.tabs.length&&this.selectTab(this.tabs[0].hash)},methods:{findTab(t){return this.tabs.find(e=>e.hash===t)},selectTab(t,e){e&&!this.options.useUrlFragment&&e.preventDefault();const i=this.findTab(t);i&&(i.isDisabled?e.preventDefault():this.lastActiveTabHash!==i.hash?(this.tabs.forEach(t=>{t.isActive=t.hash===i.hash}),this.$emit("changed",{tab:i}),this.activeTabHash=i.hash,this.activeTabIndex=this.getTabIndex(t),this.lastActiveTabHash=this.activeTabHash=i.hash):this.$emit("clicked",{tab:i}))},setTabVisible(t,e){const i=this.findTab(t);i&&(i.isVisible=e,i.isActive&&(i.isActive=e,this.tabs.every(t=>!t.isVisible||(t.isActive=!0,!1))))},getTabIndex(t){const e=this.findTab(t);return this.tabs.indexOf(e)},getTabHash(t){const e=this.tabs.find(e=>this.tabs.indexOf(e)===t);if(e)return e.hash},getActiveTab(){return this.findTab(this.activeTabHash)},getActiveTabIndex(){return this.getTabIndex(this.activeTabHash)}}},S=T,j=(i("54a9"),i("2877")),I=Object(j["a"])(S,k,D,!1,null,"0d195260",null),P=I.exports,E=function(){var t=this,e=t._self._c;return e("section",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"tabs-component-panel",attrs:{"aria-hidden":!t.isActive,id:t.computedId,role:"tabpanel"}},[t._t("default")],2)},A=[],$={props:{id:{default:null},name:{required:!0},prefix:{default:""},suffix:{default:""},isDisabled:{default:!1}},data:()=>({isActive:!1,isVisible:!0}),computed:{header(){return this.prefix+this.name+this.suffix},computedId(){return this.id?this.id:this.name.toLowerCase().replace(/ /g,"-")},hash(){return this.isDisabled?"#":"#"+this.computedId}}},O=$,L=Object(j["a"])(O,E,A,!1,null,null,null),F=L.exports,G={name:"ImportJSON",components:{Tabs:P,Tab:F},data(){return{file:null,importToSelectedNode:!1}},methods:{fileChange(){var t;if(this.file=this.$refs.file.files[0],this.file)return"application/json"!==(null===(t=this.file)||void 0===t?void 0:t.type)?(this.file=null,alert("Improted file should have .json extension")):void 0},importFromFile(){if(!this.file)return;const t=new FileReader;t.onload=t=>{var e;null!==(e=t.target)&&void 0!==e&&e.result&&(N.import(JSON.parse(t.target.result)),this.$modal.hide("import-export-modal"))},t.readAsText(this.file)},importFromClipboard(){navigator.clipboard.readText().then(t=>{N.import(JSON.parse(t)),this.$modal.hide("import-export-modal")}).catch(t=>{alert("Failed to import from clipboard\nYou see this error either becuase there Clipboard permission is not granted,\nor clipboard content is not a valid JSON",t)})}}},R=G,M=(i("ba9e"),Object(j["a"])(R,h,p,!1,null,"726764da",null)),q=M.exports,H=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e("tabs",[e("tab",{attrs:{name:"Show In New Tab"}},[e("div",{staticClass:"export-tab"},[e("div",{staticClass:"checkbox",class:{checked:t.exportSelectedNode}},[e("label",{staticClass:"checkbox-label",attrs:{for:"export-selected-new-tab"}},[t._v("Export from selected node")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.exportSelectedNode,expression:"exportSelectedNode"}],attrs:{type:"checkbox",id:"export-selected-new-tab"},domProps:{checked:Array.isArray(t.exportSelectedNode)?t._i(t.exportSelectedNode,null)>-1:t.exportSelectedNode},on:{change:function(e){var i=t.exportSelectedNode,o=e.target,n=!!o.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);o.checked?r<0&&(t.exportSelectedNode=i.concat([s])):r>-1&&(t.exportSelectedNode=i.slice(0,r).concat(i.slice(r+1)))}else t.exportSelectedNode=n}}})]),e("div",{staticClass:"export-button"},[e("button",{on:{click:t.showInNewTab}},[t._v("Export")])])])]),e("tab",{attrs:{name:"Download File"}},[e("div",{staticClass:"export-tab"},[e("div",{staticClass:"row"},[e("span",{staticClass:"name-input"},[e("label",{attrs:{for:"export-file-name"}},[t._v("Filename")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filename,expression:"filename"}],attrs:{id:"export-file-name",type:"text",placeholder:t.defaultFilename},domProps:{value:t.filename},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.filename=e.target.value)}}})]),e("div",{staticClass:"checkbox",class:{checked:t.exportSelectedNode}},[e("label",{staticClass:"checkbox-label",attrs:{for:"export-selected-download"}},[t._v("Export from selected node")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.exportSelectedNode,expression:"exportSelectedNode"}],attrs:{type:"checkbox",id:"export-selected-download"},domProps:{checked:Array.isArray(t.exportSelectedNode)?t._i(t.exportSelectedNode,null)>-1:t.exportSelectedNode},on:{change:function(e){var i=t.exportSelectedNode,o=e.target,n=!!o.checked;if(Array.isArray(i)){var s=null,r=t._i(i,s);o.checked?r<0&&(t.exportSelectedNode=i.concat([s])):r>-1&&(t.exportSelectedNode=i.slice(0,r).concat(i.slice(r+1)))}else t.exportSelectedNode=n}}})])]),e("div",{staticClass:"export-button"},[e("button",{on:{click:t.downloadFile}},[t._v("Export")])])])])],1)],1)},B=[],U={name:"ExportJSON",components:{Tabs:P,Tab:F},data(){return{exportSelectedNode:!1,filename:"",defaultFilename:"tree-data"}},methods:{stringifiedTree(){return JSON.stringify(this.exportSelectedNode?N.lastNode.export():N.export(),null,"  ")},showInNewTab(){let t=this.stringifiedTree();var e=window.open("about:blank","_blank");e.document.write(`<pre>${t}</pre>`),e.document.close()},downloadFile(){let t=this.stringifiedTree(),e=new Blob([t],{type:"application/json"}),i=document.createElement("a");i.download=(this.filename||this.defaultFilename)+".json",i.href=(window.webkitURL||window.URL).createObjectURL(e),i.dataset.downloadurl=["application/json",i.download,i.href].join(":"),i.click()}}},J=U,Y=(i("f3a4"),Object(j["a"])(J,H,B,!1,null,"a7b00144",null)),K=Y.exports,W={name:"ImportExportModal",components:{ImportJSON:q,ExportJSON:K},data(){return{currTab:""}},methods:{beforeOpen(t){this.currTab=t.params}}},X=W,Q=(i("90c2"),Object(j["a"])(X,c,u,!1,null,"8c80905c",null)),V=Q.exports,z=function(){var t=this,e=t._self._c;return e("modal",{attrs:{name:"docs-modal",adaptive:!0,height:"auto",width:"30%"},on:{"before-close":t.beforeClose}},[e("div",{staticClass:"doc-menu"},[e("div",{staticClass:"buttons"},[e("button",{staticClass:"doc-new",on:{click:t.createNewDocument}},[e("b-icon",{attrs:{icon:"file-earmark-plus"}})],1)]),e("div",{staticClass:"doc-list"},t._l(t.documents,(function(i,o){return e("div",{key:o,staticClass:"doc",class:{active:t.activeDoc(o)},on:{click:function(e){return t.setDocument(o)}}},[o!==t.editingDoc?e("div",{staticClass:"content"},[e("span",{staticClass:"doc-name"},[t._v(t._s(i.name))]),e("span",[i.lastEdit?e("span",{staticClass:"doc-date"},[t._v(t._s(t.timeAgo(i.lastEdit)))]):t._e(),e("button",{on:{click:function(e){return e.stopPropagation(),t.enterDocEdit(i,o)}}},[e("b-icon",{attrs:{icon:"pencil-square"}})],1),e("button",{on:{click:function(e){return e.stopPropagation(),t.deleteDocument(o)}}},[e("b-icon",{attrs:{icon:"trash"}})],1)])]):e("div",{staticClass:"content"},[e("div",{staticClass:"name-input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newDocName,expression:"newDocName"}],ref:"docNameInput",refInFor:!0,attrs:{type:"text"},domProps:{value:t.newDocName},on:{click:function(t){t.stopPropagation()},keydown:[function(t){t.stopPropagation()},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveDocName(i)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.leaveDocEdit()}],mousewheel:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.newDocName=e.target.value)}}})]),e("div",[e("button",{on:{click:function(e){return t.leaveDocEdit(i)}}},[e("b-icon",{attrs:{icon:"x"}})],1),e("button",{on:{click:function(e){return t.saveDocName(i)}}},[e("b-icon",{attrs:{icon:"check2"}})],1)])])])})),0)])])},Z=[],tt={name:"DocumentsList",data(){return{store:_,newDocName:"",editingDoc:"",currTab:""}},computed:{documents(){return _.state.documents}},methods:{...Object(g["b"])({setDocumentAction:"setDocument",createDocumentAction:"createDocument",deleteDocumentAction:"deleteDocument"}),setDocument(t){this.setDocumentAction(t).then(t=>N.parseTreeData(t))},createNewDocument(){this.createDocumentAction().then(t=>N.parseTreeData(t))},enterDocEdit(t,e){this.newDocName=t.name,this.editingDoc=e,this.$nextTick(()=>{this.$refs.docNameInput&&this.$refs.docNameInput[0]&&this.$refs.docNameInput[0].focus()})},leaveDocEdit(){this.newDocName="",this.editingDoc=""},saveDocName(t){t.name=this.newDocName,this.leaveDocEdit()},deleteDocument(t){this.deleteDocumentAction(t).then(e=>{this.activeDoc(t)||N.parseTreeData(e)})},activeDoc(t){return t===_.state.settings.lastDocument},beforeClose(){this.newDocName="",this.editingDoc=""},timeAgo(t){const e=new Date(t),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${e.getHours()}:${e.getMinutes()} ${e.getDate()} ${i[e.getMonth()]}`}}},et=tt,it=(i("0ac6"),Object(j["a"])(et,z,Z,!1,null,"fdd9583a",null)),ot=it.exports,nt=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"slide"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"}],staticClass:"bar"},[e("div",{staticClass:"title"},[e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],attrs:{type:"text"},domProps:{value:t.searchInput},on:{keydown:function(t){t.stopPropagation()},mousewheel:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.searchInput=e.target.value)}}}),e("span",{staticClass:"input-icon"},[e("b-icon",{attrs:{"shift-v":"4",icon:"search"}})],1)]),e("button",{on:{click:t.close}},[e("b-icon",{attrs:{"shift-v":"4",icon:"x"}})],1)]),t.favorites.length?e("div",{staticClass:"favorites-list"},[e("span",{staticClass:"title"},[t._v("Favorites:")]),e("div",{staticClass:"flex-wrapper"},t._l(t.favorites,(function(i){return e("div",{key:i.key},[e("div",{staticClass:"emoji",class:{selected:t.isSelected(i.key)},attrs:{title:i.key},domProps:{textContent:t._s(i.emoji)},on:{click:function(e){return t.toggleEmoji(i.key)},contextmenu:function(e){return e.preventDefault(),t.toggleFavorite(i.key)}}})])})),0),e("hr")]):t._e(),t.currentNodeEmoji.length?e("div",{staticClass:"favorites-list"},[e("span",{staticClass:"title"},[t._v("Current node:")]),e("div",{staticClass:"flex-wrapper"},t._l(t.currentNodeEmoji,(function(i){return e("div",{key:i.key},[e("div",{staticClass:"emoji",attrs:{title:i.key},domProps:{textContent:t._s(i.emoji)},on:{click:function(e){return t.toggleEmoji(i.key)},contextmenu:function(e){return e.preventDefault(),t.toggleFavorite(i.key)}}})])})),0),e("hr")]):t._e(),t.searchInput?e("div",{staticClass:"emoji-list"},[e("div",{staticClass:"flex-wrapper"},t._l(t.searchResult,(function(i){return e("div",{key:i.key},[e("div",{staticClass:"emoji",class:{selected:t.isSelected(i.key)},attrs:{title:i.key},domProps:{textContent:t._s(i.emoji)},on:{click:function(e){return t.toggleEmoji(i.key)}}})])})),0)]):e("div",{staticClass:"emoji-list"},[e("div",{staticClass:"flex-wrapper"},t._l(t.emojis.emoji,(function(i,o){return e("div",{key:o,staticClass:"emoji",class:{selected:t.isSelected(o)},attrs:{title:o},domProps:{textContent:t._s(i)},on:{click:function(e){return t.toggleEmoji(o)},contextmenu:function(e){return e.preventDefault(),t.toggleFavorite(o)}}})})),0)])])])},st=[],rt=i("b90b"),at=i.n(rt);const dt=new o["default"],lt=[{title:"Add Child",icon:"diagram2",event:"tree-add-child",hotkey:"tab",options:{prevent:!0}},{title:"Add Sibling",icon:"node-plus",event:"tree-add-sibling",hotkey:"enter"},{title:"Collapse Node",icon:"arrows-collapse",event:"tree-node-collapse",hotkey:"c"},{title:"Edit Node",icon:"pencil",event:"tree-node-edit",hotkey:"e",options:{prevent:!0}},{title:"Toggle Node Done State",icon:"check2",event:"tree-node-toggle-done",hotkey:"d"},{title:"Delete Node",icon:"trash",event:"tree-delete-last-node",hotkey:["delete","backspace"]},{title:"Cursor Up",event:"tree-go-up",hotkey:"arrowup",UIIgnore:!0},{title:"Cursor Right",event:"tree-go-right",hotkey:"arrowright",UIIgnore:!0},{title:"Cursor Down",event:"tree-go-down",hotkey:"arrowdown",UIIgnore:!0},{title:"Cursor Left",event:"tree-go-left",hotkey:"arrowleft",UIIgnore:!0},{title:"Save Document",event:"document-save",hotkey:"ctrl+s",options:{prevent:!0},UIIgnore:!0}],ct={};function ut(){window.addEventListener("keydown",ht),window.addEventListener("unload",gt);for(let t of lt){t.hotkey instanceof Array||(t.hotkey=[t.hotkey]);for(let e of t.hotkey){const i=e.toLowerCase();ct[i]?console.error("Multiple hotkeys binding on single event: "+t.event):ct[i]=t}}}function ht(t){const e=pt(t),i=ct[e];function o(e,i={prevent:!1}){i.prevent&&t.preventDefault(),dt.$emit(e)}i&&o(i.event,i.options)}function pt(t){let e=[];return t.ctrlKey&&"Control"!==t.key&&e.push("ctrl"),t.altKey&&"Alt"!==t.key&&e.push("alt"),t.shiftKey&&"Shift"!==t.key&&e.push("shift"),e.push(t.key.toLowerCase()),e.join("+")}function gt(){window.removeEventListener("keydown",ht),window.removeEventListener("unload",gt)}var mt={name:"EmojiBar",data(){return{emojis:at.a,tree:N,searchInput:"",shown:!1,favoritesRaw:_.state.favoriteEmojis||[]}},computed:{favorites(){return this.favoritesRaw.map(t=>at.a.find(t))},currentNodeEmoji(){var t,e;return(null===(t=this.tree.lastNode)||void 0===t||null===(e=t.emoji)||void 0===e?void 0:e.map(t=>at.a.find(t)))||[]},searchResult(){return at.a.search(this.searchInput)}},methods:{toggleEmoji(t){t&&dt.$emit("tree-node-toggle-emoji",t)},toggleFavorite(t){t&&(this.favorites.some(e=>e.key===t)?this.removeFavorite(t):this.addFavorite(t))},addFavorite(t){t&&_.commit("addFavoriteEmoji",t)},removeFavorite(t){t&&_.commit("removeFavoriteEmoji",t)},isSelected(t){if(t)return this.currentNodeEmoji.some(e=>e.key===t)},toggle(){this.shown?this.close():this.open()},close(){this.shown=!1},open(){this.shown=!0}}},ft=mt,vt=(i("7ccd"),Object(j["a"])(ft,nt,st,!1,null,null,null)),bt=vt.exports,_t={name:"Toolbar",components:{DocumentsList:ot,EmojiBar:bt,ImportExportModal:V},data(){return{tree:N,events:lt,actions:[{title:"Add child",icon:"diagram2",event:"tree-add-child"},{title:"Add sibling",icon:"node-plus",event:"tree-add-sibling"},{title:"Collapse",cond:()=>N.lastNode.collapsible,icon:"arrows-collapse",event:"tree-node-collapse"},{title:"Expand",cond:()=>N.lastNode.expandable,icon:"arrows-expand",event:"tree-node-collapse"},{title:"Edit",icon:"pencil",event:"tree-node-edit"},{title:"Drill down",cond:()=>N.lastNode.canDrillDown,icon:"arrow-bar-down",event:"tree-push-root"},{title:"Drill up",cond:()=>N.lastNode.canDrillUp,icon:"arrow-bar-up",event:"tree-pop-root"},{title:"Mark done",icon:"check2",event:"tree-node-toggle-done"},{title:"Do all children",cond:()=>N.lastNode.childrenLength>0,icon:"check2-square",event:"tree-node-do-all-children"},{title:"Undo all children",cond:()=>N.lastNode.childrenLength>0,icon:"x-square",event:"tree-node-undo-all-children"}]}},methods:{...Object(g["d"])(["addCard","deleteAllCards"]),emitEvent(t){t&&dt.$emit(t)},condSatisfied(t){return!t.cond||("function"===typeof t.cond?t.cond():0!=t.cond)},toggleEmojiBar(){var t,e;null===(t=this.$refs)||void 0===t||null===(e=t.emojiBar)||void 0===e||e.toggle()},toggleDocMenu(){this.$modal.show("docs-modal")},toggleImportExportModal(t){this.$modal.show("import-export-modal",t)},spawnCard(t){this.addCard(new v("","",{editing:!0,x:t.clientX,y:t.clientY,dragging:!0}))}}},yt=_t,xt=(i("7b63"),i("24f4"),Object(j["a"])(yt,d,l,!1,null,"938189b0",null)),Ct=xt.exports,wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"breadcrumb-query"},[e("span",t._l(t.query,(function(i,o){return e("span",{key:o},[e("a",{attrs:{href:"#"},on:{click:function(e){return t.popStack(o)}}},[t._v(t._s(i))]),o+1<t.queryLen?e("b-icon",{attrs:{icon:"chevron-right","shift-v":"-1","shift-h":"1"}}):t._e()],1)})),0)])},Nt=[],kt={name:"Breadcrumb",computed:{query(){return N.query.map(t=>t.name)},queryLen(){return N.query.length}},methods:{popStack(t){N.spliceRootsQuery(N.query.length-t)}}},Dt=kt,Tt=(i("0bfd"),Object(j["a"])(Dt,wt,Nt,!1,null,null,null)),St=Tt.exports,jt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"},{name:"on-clickaway",rawName:"v-on-clickaway:mousedown",value:t.close,expression:"close",arg:"mousedown"}],ref:"contextMenu",staticClass:"context-menu",style:t.style,attrs:{tabindex:"0"},on:{click:function(e){return t.close()},contextmenu:function(t){t.preventDefault()}}},[t._t("items")],2)},It=[],Pt=i("723b"),Et={mixins:[Pt["mixin"]],computed:{style(){return{top:this.top+"px",left:this.left+"px"}}},data(){return{top:0,left:0,shown:!1}},methods:{open(t){var e,i,o,n;if(!t)return;let s=t.pageY||t.clientY,r=t.pageX||t.clientX,a=(null===(e=this.$refs)||void 0===e||null===(i=e.contextMenu)||void 0===i?void 0:i.clientHeight)||170,d=(null===(o=this.$refs)||void 0===o||null===(n=o.contextMenu)||void 0===n?void 0:n.clientWidth)||0,l=s,c=l+a,u=r,h=u+d;Math.max(c,window.innerHeight)===c&&(l-=a),Math.max(h,.5*window.innerWidth)===h&&(u-=d),this.top=l,this.left=u,this.$nextTick(()=>this.$el.focus()),this.shown=!0},close(){this.shown&&(this.shown=!1,this.$emit("close-event"),this.left=0,this.top=0)}}},At=Et,$t=(i("97fa"),Object(j["a"])(At,jt,It,!1,null,"d1b84f7e",null)),Ot=$t.exports,Lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cards-wrapper"},[e("div",{staticClass:"cards"},[e("emoji-picker",{ref:"picker",on:{pick:t.emojiPick}}),t._l(t.cardGroups,(function(i){return e("card-group",{key:i.id,attrs:{group:i,boundaries:t.boundaries,targetGroup:t.targetGroup,draggingCard:t.draggingCard},on:{"set-dragging-card":t.setDraggingCard,"set-target-group":t.setTargetGroup,"open-picker":t.openPicker,"close-picker":t.closePicker}})})),t._l(t.cards,(function(i){return e("card",{key:i.id,attrs:{card:i,targetGroup:t.targetGroup,boundaries:t.boundaries},on:{"set-dragging-card":t.setDraggingCard,"set-target-group":t.setTargetGroup,"open-picker":t.openPicker,"close-picker":t.closePicker}})}))],2)])},Ft=[],Gt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:t.clickOutside,expression:"clickOutside"}],staticClass:"card-container",class:{"on-top":t.card.focused},style:{top:t.card.y+"px",left:t.card.x+"px",position:t.isChild?"static":"absolute","pointer-events":t.card.noPointerEvents?"none":"auto"},on:{mousedown:t.dragStart,click:function(e){return t.focusCard(!0)}}},[e("div",{staticClass:"card-overlay"},[e("div",{ref:"card",staticClass:"playing-card"},[e("div",{staticClass:"text"},[e("div",{staticClass:"icon",on:{click:function(e){return e.preventDefault(),t.$emit("open-picker",[e,t.card.id])},mouseover:function(e){t.iconHover=!0},mouseleave:function(e){t.iconHover=!1}}},[!t.card.icon&&t.iconHover?e("b-icon",{attrs:{icon:"pencil",scale:"0.8"}}):t._e(),t._v(" "+t._s(t.card.icon)+" ")],1),t.card.editing?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.card.text,expression:"card.text"}],ref:"textarea",attrs:{placeholder:"Card text...",rows:"3"},domProps:{value:t.card.text},on:{click:t.focus,mousedown:function(t){t.stopPropagation()},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),void(t.card.editing=!1))},function(t){t.stopPropagation()}],input:function(e){e.target.composing||t.$set(t.card,"text",e.target.value)}}}):e("span",{domProps:{textContent:t._s(t.card.text)}})])]),t.card.focused?e("div",{staticClass:"controls"},[e("button",{on:{click:function(e){return t.deleteCard(t.card.id)}}},[e("b-icon",{attrs:{icon:"x",scale:"0.7"}})],1),e("button",{on:{click:t.edit}},[e("b-icon",{attrs:{icon:"pencil",scale:"0.7"}})],1),e("button",{on:{click:t.group}},[e("b-icon",{attrs:{icon:"grid",scale:"0.7"}})],1)]):t._e()])])},Rt=[];class Mt{constructor(t=100,e=100,i=[],o=!1){this.id=f(),this.cards=i,this.x=t,this.y=e,this.collapsed=o}addCard(t){this.cards.push(t)}deleteCard(t){const e=this.cards.findIndex(e=>e.id===t);e<0||this.cards.splice(e,1)}}var qt={mixins:[Pt["mixin"]],props:{card:{required:!0},targetGroup:{default:null},boundaries:{default:null}},computed:{isChild(){return!!this.card.group}},watch:{boundaries(t){var e,i;if(this.isChild)return;this.oldBounds||(this.oldBounds=t);const o=((null===t||void 0===t?void 0:t.width)||0)-((null===(e=this.oldBounds)||void 0===e?void 0:e.width)||0),n=((null===t||void 0===t?void 0:t.height)||0)-((null===(i=this.oldBounds)||void 0===i?void 0:i.height)||0),s=this.card.x+o,r=this.card.y+n;s>=0&&s<=t.width&&(this.card.x=s),r>=0&&r<=t.height&&(this.card.y=r),this.oldBounds=t}},data(){return{shift:{x:0,y:0},origin:{x:0,y:0},cardClone:null,dragging:!1,iconHover:!1,oldBounds:null,cardWidth:120,cardHeight:170}},created(){window.addEventListener("mousemove",this.drag),window.addEventListener("mouseup",this.dragEnd)},methods:{...Object(g["d"])(["addCard","setCardDProperty","createGroup","deleteCard"]),...Object(g["b"])(["addCardToGroup"]),dragStart(t){const e=this.$refs.card.getBoundingClientRect();this.shift.x=t.clientX-e.left,this.shift.y=t.clientY-e.top,this.origin.x=e.left,this.origin.y=e.top,this.dragging=!0,this.$emit("set-dragging-card",!0)},drag(t){if(!this.dragging)return;const e=t.clientX-this.shift.x,i=t.clientY-this.shift.y;this.isChild&&(Math.abs(this.origin.x-e)>100||Math.abs(this.origin.y-i)>100)&&this.ungroup(),e>0&&this.inbound("width",e)&&(this.card.x=e),i>0&&this.inbound("height",i)&&(this.card.y=i),this.card.noPointerEvents=!0},dragEnd(){this.dragging&&(this.targetGroup&&this.addCardToGroup({cardID:this.card.id,groupID:this.targetGroup}),this.dragging=!1,this.card.noPointerEvents=!1,this.$emit("set-target-group",null),this.$emit("set-dragging-card",!1))},inbound(t,e){return!this.boundaries||e+this.cardWidth<=this.boundaries[t]},focus(){this.$nextTick(()=>this.$refs.textarea.focus())},focusCard(t){this.card.focused=!!t},edit(){this.card.editing=!this.card.editing,this.card.editing&&this.$nextTick(this.focus)},clickOutside(){this.focusCard(!1),this.$emit("close-picker",this.card.id)},group(){const t=new Mt(this.card.x,this.card.y,[this.card.id]);this.createGroup(t),this.addCardToGroup({cardID:this.card.id,groupID:t.id})},ungroup(){this.$set(this.card,"group",null)}}},Ht=qt,Bt=(i("f328"),Object(j["a"])(Ht,Gt,Rt,!1,null,"3c2682f0",null)),Ut=Bt.exports,Jt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card-group",style:{top:t.group.y+"px",left:t.group.x+"px"},on:{mouseenter:t.hover,mouseleave:t.unhover}},[e("div",{staticClass:"container"},[e("div",{staticClass:"controls"},[e("div",{staticClass:"control",class:{active:t.dragging},attrs:{title:"Move"},on:{mousedown:t.dragStart}},[e("b-icon",{attrs:{icon:"arrows-move"}})],1),t.cards.length>1&&!t.showSnaps?e("div",{staticClass:"control",class:{active:t.orderMode},attrs:{title:"Order"},on:{click:function(e){t.orderMode=!t.orderMode}}},[e("b-icon",{attrs:{icon:"arrow-left-right"}})],1):t._e(),t.showSnaps?t._e():e("div",{staticClass:"control",attrs:{title:"Delete"}},[e("b-icon",{attrs:{icon:"x"},on:{click:function(e){return t.deleteGroup(t.group.id)}}})],1),e("div",{staticClass:"control",class:{active:t.showSnaps}},[e("b-icon",{attrs:{icon:"grid"},on:{click:function(e){t.showSnaps=!t.showSnaps}}})],1),t.showSnaps?e("div",{staticClass:"control",class:{active:t.snap.top}},[e("b-icon",{attrs:{icon:"align-top"},on:{click:function(e){return t.snapTo("top")}}})],1):t._e(),t.showSnaps?e("div",{staticClass:"control",class:{active:t.snap.right}},[e("b-icon",{attrs:{icon:"align-end"},on:{click:function(e){return t.snapTo("right")}}})],1):t._e(),t.showSnaps?e("div",{staticClass:"control",class:{active:t.snap.bottom}},[e("b-icon",{attrs:{icon:"align-bottom"},on:{click:function(e){return t.snapTo("bottom")}}})],1):t._e(),t.showSnaps?e("div",{staticClass:"control",class:{active:t.snap.left}},[e("b-icon",{attrs:{icon:"align-start"},on:{click:function(e){return t.snapTo("left")}}})],1):t._e()]),e("draggable",{staticClass:"cards",class:{target:t.isTarget},attrs:{handle:".handle",animation:"200"},on:{change:t.change},model:{value:t.cards,callback:function(e){t.cards=e},expression:"cards"}},t._l(t.cards,(function(i){return e("div",{key:i.id,staticClass:"card-wrapper"},[t.orderMode?e("div",{staticClass:"handle"},[e("b-icon",{attrs:{icon:"grip-horizontal",scale:"1"}})],1):t._e(),e("card",{attrs:{card:i,targetGroup:t.targetGroup},on:{"open-picker":t.openPicker,"close-picker":t.closePicker,"set-dragging-card":function(e){return t.$emit("set-dragging-card",e)}}})],1)})),0)],1)])},Yt=[],Kt=i("b76a"),Wt=i.n(Kt),Xt={props:{group:{required:!0},targetGroup:{default:null},draggingCard:{default:!1},boundaries:{default:null}},components:{draggable:Wt.a,Card:Ut},computed:{...Object(g["c"])(["groupedCards"]),cards:{get(){const t=this.groupedCards.filter(t=>this.group.id===t.group).sort((t,e)=>t.orderInGroup-e.orderInGroup);return t.length?t:(this.deleteGroup(this.group.id),[])},set(){}},isTarget(){return this.draggingCard&&this.targetGroup===this.group.id},snap(){return this.group.snap||this.setSnap(),this.group.snap},isSnapped(){return Object.values(this.snap).some(t=>!0===t)}},watch:{snap:{deep:!0,handler:"reposition"},boundaries(t){this.oldBounds||(this.oldBounds=t),this.reposition(),this.oldBounds=t}},data(){return{dragging:!1,shift:{x:0,y:0},oldBounds:null,orderMode:!1,showSnaps:!1}},mounted(){window.addEventListener("mousemove",this.drag),window.addEventListener("mouseup",this.dragStop)},methods:{...Object(g["b"])(["changeCardPosition","deleteGroup"]),change(t){var e;const i=null===t||void 0===t||null===(e=t.moved)||void 0===e?void 0:e.element;i&&this.changeCardPosition({cardID:i.id,groupID:i.group,newIndex:t.moved.newIndex})},hover(){this.draggingCard&&this.$emit("set-target-group",this.group.id)},unhover(){this.draggingCard&&this.$emit("set-target-group",null)},dragStart(t){this.dragging=!0;const e=this.$el.getBoundingClientRect();this.shift.x=t.clientX-e.left,this.shift.y=t.clientY-e.top},drag(t){var e,i;if(!this.dragging)return;const o=this.$el.getBoundingClientRect(),n=t.clientX-this.shift.x,s=t.clientY-this.shift.y;!this.snap.left&&!this.snap.right&&n>0&&n+o.width<=(null===(e=this.boundaries)||void 0===e?void 0:e.width)&&(this.group.x=n),!this.snap.top&&!this.snap.bottom&&s>0&&s+o.height<=(null===(i=this.boundaries)||void 0===i?void 0:i.height)&&(this.group.y=s)},dragStop(){this.dragging=!1},openPicker(t){this.$emit("open-picker",t)},closePicker(t){this.$emit("close-picker",t)},setSnap(){this.$set(this.group,"snap",{top:!1,right:!1,bottom:!1,left:!1})},snapTo(t){function e(t){const e={top:"bottom",right:"left",bottom:"top",left:"right"};return e[t]}null!==this.group.snap&&"object"===typeof this.group.snap||this.setSnap(),this.group.snap[t]=!this.group.snap[t],this.group.snap[e(t)]=!1},resetSnap(){Object.keys(this.group.snap).forEach(t=>this.group.snap[t]=!1)},reposition(){const t=this.$el.getBoundingClientRect(),e=this.boundaries;let i,o;if(this.isSnapped)this.snap.top&&(o=85),this.snap.right&&(i=e.width-t.width),this.snap.bottom&&(o=e.height-t.height-10),this.snap.left&&(i=10);else{var n,s;const t=((null===e||void 0===e?void 0:e.width)||0)-((null===(n=this.oldBounds)||void 0===n?void 0:n.width)||0),r=((null===e||void 0===e?void 0:e.height)||0)-((null===(s=this.oldBounds)||void 0===s?void 0:s.height)||0);i=this.group.x+t,o=this.group.y+r}i>=0&&i+t.width<=e.width&&(this.group.x=i),o>=0&&o+t.height<=e.height&&(this.group.y=o)}}},Qt=Xt,Vt=(i("a8c1"),Object(j["a"])(Qt,Jt,Yt,!1,null,"eeb1ba56",null)),zt=Vt.exports,Zt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"}],staticClass:"picker",style:{top:t.y+"px",left:t.x+"px"}},t._l(t.emojis.emoji,(function(i,o){return e("div",{key:o,staticClass:"emoji",attrs:{title:o},domProps:{textContent:t._s(i)},on:{click:function(e){return t.pick({key:o,emoji:i})}}})})),0)},te=[],ee={data(){return{emojis:at.a,shown:!1,x:0,y:0}},methods:{open(t){const e=this.$el.getBoundingClientRect(),i=20;this.x=t.clientX+i,this.y=t.clientY-e.height-i,this.shown=!0},close(){this.shown=!1},pick(t){this.$emit("pick",t)}}},ie=ee,oe=(i("bd12"),Object(j["a"])(ie,Zt,te,!1,null,null,null)),ne=oe.exports,se={components:{Card:Ut,EmojiPicker:ne,CardGroup:zt},computed:{...Object(g["c"])(["cards"]),...Object(g["e"])(["cardGroups"])},data(){return{target:null,targetGroup:null,draggingCard:!1,boundaries:null}},mounted(){this.boundaries=this.$el.getBoundingClientRect(),window.addEventListener("resize",this.align)},methods:{...Object(g["d"])(["setCardProperty"]),align(){this.boundaries=this.$el.getBoundingClientRect()},setTargetGroup(t){this.targetGroup=t},setDraggingCard(t){this.draggingCard=t},openPicker([t,e]){this.target=e,this.$refs.picker.open(t)},closePicker(t){this.target===t&&(this.$refs.picker.close(),this.target=null)},emojiPick(t){this.setCardProperty({cardID:this.target,key:"icon",value:t.emoji})}}},re=se,ae=(i("5ce4"),Object(j["a"])(re,Lt,Ft,!1,null,"2b171ea2",null)),de=ae.exports,le=i("5698"),ce=i("5d30");const ue=Object(ce["a"])(),he=/translate\((-?\d+)px, ?(-?\d+)px\)/i,pe=/scale\((\S*)\)/i,ge={CURVE:"curve",STRAIGHT:"straight"},me=200,fe=100,ve=200,be=0;function _e(){const t=[],e="0123456789abcdef";for(let i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}function ye({x:t,y:e}){return{x:e,y:t}}var xe={name:"Tree",props:{config:{type:Object,default:()=>({nodeWidth:me,nodeHeight:fe,nodeMaxWidth:150,nodeMaxHeight:200,levelHeight:ve})},linkStyle:{type:String,default:ge.CURVE}},components:{Toolbar:Ct,ContextMenu:Ot,Breadcrumb:St,CardsWrapper:de},data(){return{d3:le,events:lt,store:_,tree:N,colors:"568FE1",nodeDataList:[],linkDataList:[],initTransformX:0,initTransformY:0,currentScale:1,nodeDrag:{dragging:!1,source:null,target:null,snap:""},key:0}},computed:{initialTransformStyle(){return{transform:`scale(1) translate(${this.initTransformX}px, ${this.initTransformY}px)`,transformOrigin:"center"}}},created(){this.addUniqueKey(this.tree.root),window.addEventListener("unload",this.beforeUnload),dt.$on("tree-push-root",this.pushRootToQuery),dt.$on("tree-pop-root",this.spliceRootsQuery),dt.$on("tree-add-sibling",this.addSibling),dt.$on("tree-add-child",this.addChild),dt.$on("tree-set-last-node",t=>{t&&t[0]&&this.setLastNode(t[0])}),dt.$on("tree-node-toggle-done",this.toggleDone),dt.$on("tree-node-toggle-emoji",this.toggleEmoji),dt.$on("tree-node-collapse",this.collapseLastNode),dt.$on("tree-node-edit",this.editLastNode),dt.$on("tree-node-do-all-children",this.doAllChildren),dt.$on("tree-node-undo-all-children",this.undoAllChildren),dt.$on("tree-delete-last-node",this.deleteLastNode),dt.$on("tree-go-up",this.goUp),dt.$on("tree-go-down",this.goDown),dt.$on("tree-go-left",this.goLeft),dt.$on("tree-go-right",this.goRight),dt.$on("document-save",this.saveDocument)},mounted(){this.init()},methods:{...Object(g["b"])({saveDocumentAction:"saveDocument"}),isDraggedOver(t){var e,i,o,n;return(null===(e=this.nodeDrag)||void 0===e||null===(i=e.target)||void 0===i?void 0:i.data._gid)===t._gid&&(null===(o=this.nodeDrag)||void 0===o||null===(n=o.source)||void 0===n?void 0:n.data._gid)!==t._gid&&!t.isRoot},startDrag(t,e){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",e.data.collapsed=!0,this.nodeDrag.source=e},onDrag(){this.nodeDrag.dragging=!0},onDrop(t,e){this.nodeDrag.target&&this.nodeDrag.target!==e&&N.cloneNode(e.data,this.nodeDrag.target.data,this.nodeDrag.snap),e.collapsed=!1,this.nodeDrag.dragging=!1,this.nodeDrag.target=null,this.nodeDrag.source=null},mouseOverNode(t,e){if(!this.nodeDrag.dragging||e.isRoot)return;this.nodeDrag.target=e;let i=t.target.getBoundingClientRect(),o=t.clientX-i.left,n=t.clientY-i.top,s=i.height/2;o>i.width-i.width/4?this.nodeDrag.snap="right":n<s?this.nodeDrag.snap="top":n>=s&&(this.nodeDrag.snap="bottom")},mouseLeaveNode(t,e){var i,o;e.data._gid===(null===(i=this.nodeDrag)||void 0===i||null===(o=i.target)||void 0===o?void 0:o.data._gid)&&(this.nodeDrag.target=null)},beforeUnload(){this.saveDocument(),window.removeEventListener("unload",this.beforeUnload)},spliceRootsQuery(t=1){N.spliceRootsQuery(t)},pushRootToQuery(){N.lastNode&&N.pushRootToQuery(N.lastNode)},sortTree(t,e){N.sortLastNode(t,e)},addSibling(){N.addSibling(),this.focusInput("node-#"+N.lastNode._gid)},addChild(){N.addChild(),this.focusInput("node-#"+N.lastNode._gid)},toggleDone(){N.lastNode.toggleDoneState()},shouldDisplayProgress(t){var e;return null===t||void 0===t||null===(e=t.settings)||void 0===e?void 0:e.displayProgress},doAllChildren(){N.lastNode.setAllChildrenDoneState(!0)},undoAllChildren(){N.lastNode.setAllChildrenDoneState(!1)},toggleEmoji(t){N.lastNode.toggleEmoji(t)},emojifyArray(t){return null!==t&&void 0!==t&&t.length?t.map(t=>at.a.get(t)):""},setLastNode(t,e){var i,o;if(1===(null===e||void 0===e?void 0:e.which)&&N.lastNode._gid===t._gid)return this.collapseLastNode();N.lastNode=t,null===(i=this.$refs)||void 0===i||null===(o=i.contextMenu)||void 0===o||o.close()},editLastNode(){N.lastNode.editing=!0,this.focusInput("node-#"+N.lastNode._gid)},blurLastNode(t){N.blurLastNode(t)},collapseLastNode(){N.collapseLastNode()},deleteLastNode(){N.deleteLastNode()},quitNodeEditor(t,e={save:!1,callback:null}){if(t.shiftKey)return N.lastNode._name+="\n";N.lastNode.firstEdit&&!e.save?N.deleteLastNode({force:!0}):(N.lastNode.editing=!1,N.lastNode.parseName()),"function"===typeof e.callback&&e.callback()},goUp(){N.goUp()},goDown(){N.goDown()},goLeft(){N.goLeft()},goRight(){N.goRight()},clickedText(t){this.setLastNode(t.data)},clickedNode(t){this.setLastNode(t),N.collapseLastNode()},focusInput(t){t&&this.$nextTick(()=>{const e=this.$refs[t];e&&e[0]&&e[0].focus()})},saveDocument(){this.saveDocumentAction(N.export())},handleZoom(t){if(2===t.which)return this.restoreScale();t.which||(((t.deltaY||-t.wheelDelta||t.detail)>>10||1)<0?this.zoomIn():this.zoomOut())},init(){this.draw(),this.enableDrag(),this.initTransform()},zoomIn(){var t,e;const i=null===(t=this.$refs.domContainer)||void 0===t||null===(e=t.style)||void 0===e?void 0:e.transform;if(!i)return;let o=1.2;const n=i.match(pe);if(n&&n.length>0){const t=parseFloat(n[1]);o*=t}this.setScale(o)},zoomOut(){var t,e;const i=null===(t=this.$refs.domContainer)||void 0===t||null===(e=t.style)||void 0===e?void 0:e.transform;if(!i)return;let o=1/1.2;const n=i.match(pe);if(n&&n.length>0){const t=parseFloat(n[1]);o=t/1.2}this.setScale(o)},restoreScale(){this.setScale(1)},setScale(t){var e,i;if("number"!==typeof t)return;let o=this.getTranslate();if(!o)return;let n=`translate(${o[0]}px, ${o[1]}px)`;null!==(e=this.$refs.domContainer)&&void 0!==e&&null!==(i=e.style)&&void 0!==i&&i.transform&&(this.$refs.svg.style.transform=`scale(${t}) `+n,this.$refs.domContainer.style.transform=`scale(${t}) `+n,this.currentScale=t)},getTranslate(){var t;let e=null===(t=this.$refs.svg)||void 0===t?void 0:t.style.transform;if(!e)return;let i=e.match(he);if(null===i)return[null,null];let o=parseInt(i[1]),n=parseInt(i[2]);return[o,n]},addUniqueKey(t){const e=[t];while(0!==e.length){const t=e.pop();t._key=_e(),t.children&&e.push(...t.children)}return t},initTransform(){const t=this.$refs.container.offsetHeight;this.initTransformX=Math.floor(this.config.nodeWidth),this.initTransformY=Math.floor(t/2)},generateLinkPath(t){if(this.linkStyle===ge.CURVE){const e=le["linkHorizontal"]();return e.x((function(t){return t.x})).y((function(t){return t.y})).source((function(t){const e={x:t.source.x,y:t.source.y};return ye(e)})).target((function(t){const e={x:t.target.x,y:t.target.y};return ye(e)})),e(t)}if(this.linkStyle===ge.STRAIGHT){const e=le["path"]();let i={x:t.source.x,y:t.source.y},o={x:t.target.x,y:t.target.y};i=ye(i),o=ye(o);const n=o.x-i.x,s={x:i.x+n/2,y:i.y},r={x:i.x+n/2,y:o.y};return e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.lineTo(r.x,r.y),e.lineTo(o.x,o.y),e.toString()}},draw(){const[t,e]=this.buildTree(this.tree.root);this.linkDataList=e,this.svg=this.d3.select(this.$refs.svg);const i=this,o=this.svg.selectAll(".link").data(e,t=>`${t.source.data._key}-${t.target.data._key}`);o.enter().append("path").attr("class","link").attr("d",(function(t){return i.generateLinkPath(t)})),o.transition().duration(be).ease(le["easeCubicInOut"]).attr("d",(function(t){return i.generateLinkPath(t)})),o.exit().transition().duration(be/2).ease(le["easeCubicInOut"]).style("opacity",0).remove(),this.nodeDataList=t},buildTree(t){const e=this.d3.tree().nodeSize([this.config.nodeWidth,this.config.levelHeight]),i=e(this.d3.hierarchy(t));return ue(i),[i.descendants(),i.links()]},enableDrag(){const t=this.$refs.svg,e=this.$refs.container;let i=0,o=0,n=!1,s="";e.onmousedown=e=>{s=t.style.transform,i=e.clientX,o=e.clientY,n=!0},e.onmousemove=e=>{if(!n)return;const r=s;let a=0,d=0;if(r){const t=r.match(he);if(null!==t&&0!==t.length){const[e,i]=t.slice(1);a=parseInt(e),d=parseInt(i)}}let l=Math.floor((e.clientX-i)/this.currentScale)+a,c=Math.floor((e.clientY-o)/this.currentScale)+d,u=`translate(${l}px, ${c}px)`;r&&(u=r.replace(he,u)),t.style.transform=u,this.$refs.domContainer.style.transform=u},e.onmouseleave=()=>{i=0,o=0,n=!1},e.onmouseup=()=>{i=0,o=0,n=!1}},formatDimension(t){return"number"===typeof t?t+"px":-1!==t.indexOf("px")?t:t+"px"},parseDimensionNumber(t){return"number"===typeof t?t:parseInt(t.replace("px",""))},nodeContextClick(t,e){var i;t.preventDefault(),this.setLastNode(e),null===(i=this.$refs.contextMenu)||void 0===i||i.open(t)}},watch:{"tree.root":{deep:!0,immediate:!0,handler(){this.draw(),this.saveDocument()}}}},Ce=xe,we=(i("4580"),i("88a9"),i("d469"),Object(j["a"])(Ce,r,a,!1,null,"12261730",null)),Ne=we.exports,ke={name:"App",components:{Tree:Ne},data(){return{tree:N}}},De=ke,Te=(i("543a"),Object(j["a"])(De,n,s,!1,null,null,null)),Se=Te.exports,je=i("1881"),Ie=i.n(je),Pe=i("b1e0"),Ee=i("dbbe"),Ae=i("a166");i("f9e3"),i("2dd8");ut(),o["default"].use(Ie.a,{componentName:"Modal"}),o["default"].use(Pe["a"]),o["default"].use(Ee["a"]),o["default"].use(Ae["a"]),o["default"].config.productionTip=!1,new o["default"]({render:t=>t(Se),store:_}).$mount("#app")},"5a7f":function(t,e,i){},"5ce4":function(t,e,i){"use strict";i("e928")},"64b9":function(t,e,i){},7270:function(t,e,i){},"7b63":function(t,e,i){"use strict";i("542c")},"7ccd":function(t,e,i){"use strict";i("e707")},"88a9":function(t,e,i){"use strict";i("e784")},"8ded":function(t,e,i){},"90c2":function(t,e,i){"use strict";i("e730")},"97fa":function(t,e,i){"use strict";i("9e4e")},"9e4e":function(t,e,i){},a8c1:function(t,e,i){"use strict";i("af7e")},aaec:function(t,e,i){},af7e:function(t,e,i){},ba9e:function(t,e,i){"use strict";i("64b9")},bd12:function(t,e,i){"use strict";i("17a8")},be11:function(t,e,i){},cc7e:function(t,e,i){},cf97:function(t,e,i){},d469:function(t,e,i){"use strict";i("7270")},e095:function(t,e,i){},e707:function(t,e,i){},e730:function(t,e,i){},e784:function(t,e,i){},e928:function(t,e,i){},f328:function(t,e,i){"use strict";i("aaec")},f3a4:function(t,e,i){"use strict";i("cc7e")}});
//# sourceMappingURL=app.39ad248a.js.map