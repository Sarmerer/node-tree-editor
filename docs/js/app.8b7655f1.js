(function(t){function e(e){for(var i,a,s=e[0],c=e[1],d=e[2],u=0,h=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(h.length)h.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={app:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/node-tree-editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0542":function(t,e,n){},"0db9":function(t,e,n){"use strict";n("8fc8")},"15fc":function(t,e,n){},"160f":function(t,e,n){},"18e3":function(t,e,n){"use strict";n("b7a8")},1972:function(t,e,n){},2250:function(t,e,n){"use strict";n("f69a")},"28e0":function(t,e,n){"use strict";n("0542")},"2ff8":function(t,e,n){"use strict";n("fe2f")},"31f4":function(t,e,n){"use strict";n("8748")},"3f89":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t.tree.loaded?n("tree"):t._e()],1)},r=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("context-menu",{ref:"contextMenu",scopedSlots:t._u([{key:"items",fn:function(){return[n("button",{staticClass:"context-menu-item",on:{click:t.addSibling}},[n("b-icon",{attrs:{icon:"node-plus"}}),t._v(" Add sibling ")],1),n("button",{staticClass:"context-menu-item",on:{click:t.addChild}},[n("b-icon",{attrs:{icon:"diagram2"}}),t._v(" Add child ")],1),n("button",{staticClass:"context-menu-item",on:{click:t.toggleDone}},[n("b-icon",{attrs:{icon:t.tree.lastNode.done?"x":"check2"}}),t._v(" "+t._s(t.tree.lastNode.done?"Undo":"Done")+" ")],1),t.tree.lastNode.isRoot?t._e():n("button",{staticClass:"context-menu-item",on:{click:t.pushRootToQuery}},[n("b-icon",{attrs:{icon:"arrow-bar-down"}}),t._v(" Drill down ")],1),t.tree.lastNode.childrenLength?n("button",{staticClass:"context-menu-item",on:{click:t.collapseLastNode}},[n("b-icon",{attrs:{icon:t.tree.lastNode.collapsed?"arrows-expand":"arrows-collapse"}}),t._v(" "+t._s(t.tree.lastNode.collapsed?"Expand":"Collapse")+" ")],1):t._e(),n("button",{staticClass:"context-menu-item",on:{click:t.editLastNode}},[n("b-icon",{attrs:{icon:"pencil"}}),t._v(" Edit ")],1),n("button",{staticClass:"context-menu-selector"},[n("b-icon",{attrs:{icon:"kanban"}}),t._v(" Weight: "+t._s(t.tree.lastNode.weight||1)+" "),n("ul",t._l(["Default",10,5,1,-1,-5,-10],(function(e,i){return n("li",{key:i,on:{click:function(n){return t.tree.lastNode.addWeight(e)}}},[t._v(" "+t._s(e>=0?"+"+e:e)+" ")])})),0),n("b-icon",{staticClass:"arrow",attrs:{icon:"chevron-right"}})],1),n("button",{staticClass:"context-menu-selector"},[n("b-icon",{attrs:{icon:"gear"}}),t._v(" Settings "),n("ul",t._l(t.tree.lastNode.settings,(function(e,i){return n("li",{key:i,on:{click:function(e){return t.tree.lastNode.toggleSetting(i)}}},[t._v(" "+t._s(i)+" "),e?n("b-icon",{attrs:{icon:"check2"}}):t._e()],1)})),0),n("b-icon",{staticClass:"arrow",attrs:{icon:"chevron-right"}})],1),t.tree.lastNode.deletable?n("button",{staticClass:"context-menu-item",on:{click:t.deleteLastNode}},[n("b-icon",{attrs:{icon:"node-minus"}}),t._v(" Delete ")],1):t._e()]},proxy:!0}])}),n("toolbar"),n("div",{ref:"container",staticClass:"tree-container",class:{dragging:t.nodeDrag.dragging},on:{mousewheel:t.handleZoom,mouseup:function(e){return"button"in e&&1!==e.button?null:t.handleZoom(e)}}},[n("svg",{ref:"svg",staticClass:"svg vue-tree",style:t.initialTransformStyle}),n("div",{ref:"domContainer",staticClass:"dom-container",style:t.initialTransformStyle},t._l(t.nodeDataList,(function(e){return n("div",{key:e.data._key,staticClass:"node-slot",style:{left:t.formatDimension(e.y),top:t.formatDimension(e.x),width:t.formatDimension(t.config.nodeWidth),height:t.formatDimension(t.config.nodeHeight)},on:{dragover:function(n){return n.stopPropagation(),t.mouseOverNode(n,e)},dragend:function(n){return t.onDrop(n,e)}}},[n("div",{staticClass:"node-slot-overlay",class:{"node-top":"top"===t.nodeDrag.snap&&t.isDraggedOver(e.data),"node-bottom":"bottom"===t.nodeDrag.snap&&t.isDraggedOver(e.data),"node-right":"right"===t.nodeDrag.snap&&t.isDraggedOver(e.data)}},[n("div",{staticClass:"node",class:{dragover:t.isDraggedOver(e.data),highlighted:e.data._gid===t.tree.lastNode._gid,stack:e.data.childrenLength&&e.data.collapsed,done:e.data.done,editing:e.data.editing},style:{"max-width":t.formatDimension(t.config.nodeMaxWidth),"max-height":t.formatDimension(t.config.nodeMaxHeight)},attrs:{draggable:e.data.draggable},on:{mousedown:function(t){t.stopPropagation()},click:function(n){return t.setLastNode(e.data,n)},contextmenu:function(n){return t.nodeContextClick(n,e.data)},dragstart:function(n){return t.startDrag(n,e)},drag:function(e){return t.onDrag()}}},[e.data.editing?t._e():n("div",{staticClass:"content"},[!e.data.editing&&e.data.emoji&&e.data.emoji.length?n("div",t._l(t.emojifyArray(e.data.emoji),(function(e,i){return n("span",{key:i},[t._v(t._s(e)+" ")])})),0):t._e(),e.data.editing?t._e():n("pre",{domProps:{textContent:t._s(e.data.name)},on:{mousewheel:function(t){t.stopPropagation()}}}),e.data.isRoot&&t.tree.hasQuery?n("button",{staticClass:"drill-up",on:{click:function(e){return e.stopPropagation(),t.spliceRootsQuery(e)}}},[n("b-icon",{attrs:{icon:"arrow-bar-up"}})],1):t._e()]),e.data.editing?n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.data._name,expression:"node.data._name"}],ref:"node-#"+e.data._gid,refInFor:!0,domProps:{value:e.data._name},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.quitNodeEditor(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.quitNodeEditor(e,{save:!0}))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.preventDefault(),t.quitNodeEditor(e,{save:!0,callback:t.addChild}))},function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;t.stopPropagation()}],blur:function(n){return t.blurLastNode(e.data)},mousewheel:function(t){t.stopPropagation()},input:function(n){n.target.composing||t.$set(e.data,"_name",n.target.value)}}}):t._e(),!e.data.editing&&e.data.totalChildrenTasks>0?n("sub",{staticClass:"completeness"},[t._v(t._s(e.data.finishedChildrenTasks+"/"+e.data.totalChildrenTasks))]):t._e(),t.shouldDisplayProgress(e.data)?n("div",{staticClass:"progress",class:{"round-right":100==e.data.progress},style:{width:e.data.progress+"%"},attrs:{title:e.data.progress+"%"}}):t._e(),e.data._gid===t.tree.lastNode._gid?n("div",{staticClass:"controls"},[n("button",{staticClass:"add-child",on:{click:function(e){return e.stopPropagation(),t.addSibling(e)}}},[n("b-icon",{attrs:{icon:"node-plus"}})],1),n("button",{staticClass:"add-sibling",on:{click:t.addChild}},[n("b-icon",{attrs:{icon:"diagram2"}})],1)]):t._e()])])])})),0)]),n("breadcrumb"),n("cards-wrapper")],1)},s=[],c=n("3835"),d=n("2909"),l=n("5530"),u=(n("a15b"),n("99af"),n("d81d"),n("466d"),n("ac1f"),n("d3b7"),n("25f0"),n("fb6a"),n("5319"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("modal",{attrs:{name:"info-modal",adaptive:!0,height:"auto",width:"500px"}},[n("div",{attrs:{id:"modal"}},[n("table",{staticClass:"info-table"},t._l(t.events,(function(e,i){return n("tr",{key:i,staticClass:"info-row"},[n("td",{staticClass:"info-col-action"},[t._v(" "+t._s(e.title)+" ")]),n("td",{staticClass:"info-col-hotkey"},[t._v(" "+t._s(e.hotkey.join(" / "))+" ")])])})),0)])]),n("documents-list"),n("import-export-modal",{attrs:{tab:"f"}}),n("div",{staticClass:"toolbar"},[n("div",{staticClass:"left-buttons"},t._l(t.actions,(function(e,i){return n("div",{key:i,attrs:{title:e.title}},[t.condSatisfied(e)?n("button",{on:{click:function(n){return n.stopPropagation(),t.emitEvent(e.event)}}},[n("b-icon",{attrs:{icon:e.icon}})],1):t._e()])})),0),n("div",{staticClass:"right-buttons"},[n("button",{attrs:{title:"Delete All Cards"},on:{click:t.deleteAllCards}},[n("b-icon",{attrs:{icon:"x"}})],1),n("button",{attrs:{title:"New Card"},on:{click:t.spawnCard}},[n("b-icon",{attrs:{icon:"file-post"}})],1),n("button",{staticClass:"doc-export",attrs:{title:"Export"},on:{click:function(e){return t.toggleImportExportModal("export")}}},[n("b-icon",{attrs:{icon:"upload"}})],1),n("button",{staticClass:"doc-import",attrs:{title:"Import"},on:{click:function(e){return t.toggleImportExportModal("import")}}},[n("b-icon",{attrs:{icon:"download"}})],1),n("button",{attrs:{title:"Documents"},on:{click:function(e){return e.stopPropagation(),t.toggleDocMenu(e)}}},[n("b-icon",{attrs:{icon:"file-earmark-text"}})],1),n("button",{attrs:{title:"Emoji"},on:{click:t.toggleEmojiBar}},[n("b-icon",{attrs:{icon:"emoji-smile"}})],1),n("button",{attrs:{title:"Help"},on:{click:function(e){return t.$modal.show("info-modal")}}},[n("b-icon",{attrs:{icon:"question"}})],1)])]),n("emoji-bar",{ref:"emojiBar",staticClass:"emoji-bar"})],1)}),h=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("modal",{staticClass:"helper",attrs:{name:"import-export-modal",adaptive:!0,height:"auto",width:"30%"},on:{"before-open":t.beforeOpen}},["import"===t.currTab?n("import-JSON"):n("export-JSON")],1)},p=[],g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("tabs",[n("tab",{attrs:{name:"Import From File"}},[n("div",{staticClass:"import-tab"},[n("div",{staticClass:"checkbox",class:{checked:t.importToSelectedNode}},[n("label",{staticClass:"checkbox-label",attrs:{for:"import-to-selected-from-file"}},[t._v("Import to selected node")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.importToSelectedNode,expression:"importToSelectedNode"}],attrs:{type:"checkbox",id:"import-to-selected-from-file"},domProps:{checked:Array.isArray(t.importToSelectedNode)?t._i(t.importToSelectedNode,null)>-1:t.importToSelectedNode},on:{change:function(e){var n=t.importToSelectedNode,i=e.target,o=!!i.checked;if(Array.isArray(n)){var r=null,a=t._i(n,r);i.checked?a<0&&(t.importToSelectedNode=n.concat([r])):a>-1&&(t.importToSelectedNode=n.slice(0,a).concat(n.slice(a+1)))}else t.importToSelectedNode=o}}})]),n("span",[n("input",{ref:"file",attrs:{type:"file"},on:{change:t.fileChange}})]),n("div",{staticClass:"import-button"},[n("button",{on:{click:t.importFromFile}},[t._v("Import")])])])]),n("tab",{attrs:{name:"Import From Clipboard"}},[n("div",{staticClass:"import-tab"},[n("small",[t._v("This feature requires Clipboard permission and doesn't work if it's not granted")]),n("div",{staticClass:"checkbox",class:{checked:t.importToSelectedNode}},[n("label",{staticClass:"checkbox-label",attrs:{for:"import-to-selected-from-clipboard"}},[t._v("Import to current node")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.importToSelectedNode,expression:"importToSelectedNode"}],attrs:{type:"checkbox",id:"import-to-selected-from-clipboard"},domProps:{checked:Array.isArray(t.importToSelectedNode)?t._i(t.importToSelectedNode,null)>-1:t.importToSelectedNode},on:{change:function(e){var n=t.importToSelectedNode,i=e.target,o=!!i.checked;if(Array.isArray(n)){var r=null,a=t._i(n,r);i.checked?a<0&&(t.importToSelectedNode=n.concat([r])):a>-1&&(t.importToSelectedNode=n.slice(0,a).concat(n.slice(a+1)))}else t.importToSelectedNode=o}}})]),n("div",{staticClass:"import-button"},[n("button",{on:{click:t.importFromClipboard}},[t._v("Import")])])])])],1)],1)},v=[],m=n("b85c"),b=n("d4ec"),y=n("bee2"),_=(n("a434"),n("b0c0"),n("53ca")),k=(n("c740"),n("4de4"),n("b64b"),n("6062"),n("3ca3"),n("ddb0"),n("2f62")),x=n("0e44");n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7");function C(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}var N=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{editing:!1,x:0,y:0,group:void 0,dragging:!1};Object(b["a"])(this,t),this.id=C(),this.x=i.x||0,this.y=i.y||0,this.text=e,this.icon=n,this.editing=i.editing||!1,this.group=i.group||null,this.dragging=i.dragging||!1,this.focused=!1,this.noPointerEvents=!1,this.orderInGroup=0}return Object(y["a"])(t,[{key:"isChild",get:function(){return!!this.group}}]),t}();i["default"].use(k["a"]);var w=function t(e,n){Object(b["a"])(this,t),this.name=e,this.data=n,this.lastEdit=Date.now()},D=new k["a"].Store({state:{favoriteEmojis:[],settings:{lastDocument:""},cards:[],cardGroups:[],documents:{}},plugins:[Object(x["a"])()],mutations:{addFavoriteEmoji:function(t,e){return t.favoriteEmojis.push(e)},removeFavoriteEmoji:function(t,e){return t.favoriteEmojis.splice(t.favoriteEmojis.indexOf(e),1)},setDocument:function(t,e){e&&(t.settings.lastDocument=e)},updateDocument:function(t,e){var n=e.uuid,i=e.data;Object.assign(t.documents[n],i)},addDocument:function(t,e){var n=e.uuid,i=e.document;t.documents[n]=i},addCard:function(t,e){e instanceof N&&t.cards.push(e)},addCardToGroup:function(t,e){var n=e.cardID,i=e.groupID,o=t.cards.findIndex((function(t){return t.id===n}));if(!(o<0)){t.cards[o].group=i;var r=t.cards.filter((function(t){return t.group===i}))||[];t.cards[o].orderInGroup=r>0?r+1:0}},setCardOrder:function(t,e){var n=e.cardID,i=e.newIndex,o=t.cards.findIndex((function(t){return t.id===n}));o<0||(t.cards[o].orderInGroup=i)},updateCards:function(t,e){t.cards=e},deleteCard:function(t,e){var n=t.cards.findIndex((function(t){return t.id===e}));n<0||t.cards.splice(n,1)},deleteCardsInGroup:function(t,e){var n=t.cards.map((function(t,n){return t.group===e?n:void 0})).filter((function(t){return void 0!==t}));if(n.length)for(var i=n.length-1;i>=0;i--)t.cards.splice([n[i]],1)},deleteAllCards:function(t){t.cardGroups=[],t.cards=[]},createGroup:function(t,e){t.cardGroups.push(e)},setCardProperty:function(t,e){var n=e.cardID,i=e.key,o=e.value,r=e.keyValues,a=t.cards.findIndex((function(t){return t.id===n}));if(!(a<0)&&(t.cards[a][i]=o,r&&Array.isArray(r))){var s,c=Object(m["a"])(r);try{for(c.s();!(s=c.n()).done;){var d=s.value;"object"!==Object(_["a"])(d)||l(d.key)||(t.cards[a][d.key],d.value)}}catch(u){c.e(u)}finally{c.f()}}function l(t){return void 0===t||null===t}},reorderGroup:function(t,e){var n=e.groupID,i=e.priorityIndex,o=e.priorityID,r=t.cards.filter((function(t){return t.group===n})).sort((function(t,e){return t.orderInGroup-e.orderInGroup})),a=r.findIndex((function(t){return t.id===o}));if(!(a<0)){r.splice(i,0,r.splice(a,1)[0]);for(var s=0;s<r.length;s++)s===i&&r[s].id===o||(r[s].orderInGroup=s)}},deleteGroup:function(t,e){var n=t.cardGroups.findIndex((function(t){return t.id===e}));n<0||t.cardGroups.splice(n,1)}},actions:{getTreeData:function(t){var e=t.state,n=t.dispatch;return e.settings.lastDocument&&e.documents[e.settings.lastDocument]?e.documents[e.settings.lastDocument].data:n("createDocument")},createDocument:function(t){var e=t.commit,n=t.state,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{name:"document",data:{}},o=C();return e("addDocument",{uuid:o,document:new w(i.name,i.data)}),e("setDocument",o),n.documents[o].data},setDocument:function(t,e){var n=t.commit,i=t.state;return e&&n("setDocument",e),i.documents[e].data},saveDocument:function(t,e){var n=t.commit,i=t.state,o=t.getters;o.lastDocExists&&n("updateDocument",{uuid:i.settings.lastDocument,data:{lastEdit:Date.now(),data:e}})},deleteDocument:function(t,e){var n=t.commit,o=t.state,r=t.dispatch;i["default"].delete(o.documents,e);var a=Object.keys(o.documents);return a.length?(n("setDocument",a[0]),o.documents[a[0]].data):r("createDocument")},changeCardPosition:function(t,e){var n=t.commit,i=e.cardID,o=e.groupID,r=e.newIndex;n("setCardOrder",{cardID:i,newIndex:r}),n("reorderGroup",{groupID:o,priorityIndex:r,priorityID:i})},addCardToGroup:function(t,e){var n=t.commit,i=e.cardID,o=e.groupID;n("addCardToGroup",{cardID:i,groupID:o}),n("reorderGroup",{groupID:o})},deleteGroup:function(t,e){var n=t.commit;n("deleteGroup",e),n("deleteCardsInGroup",e)}},getters:{documents:function(t){return t.documents},treeData:function(t){return t.settings.lastDocument&&t.documents[t.settings.lastDocument]?t.documents[t.settings.lastDocument].data:{}},cards:function(t){return t.cards.filter((function(t){return!t.group}))},groups:function(t,e){return Object(d["a"])(new Set(e.groupedCards.map((function(t){return t.group}))))},groupedCards:function(t){return t.cards.filter((function(t){return"string"===typeof t.group}))},lastDocExists:function(t){return!!t.documents[t.settings.lastDocument]}}}),j=(n("caad"),n("2532"),n("159b"),n("498a"),n("1276"),n("4fad"),n("b680"),n("13d5"),{displayProgress:!0,deepProgress:!0}),T=function(){function t(){var e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{name:"",firstEdit:!0,collapsed:!1,children:[],emoji:[],done:!1,isRoot:!1,weight:1,virtualChildren:0,virtualFinishedChildren:0,settings:{displayProgress:!0,deepProgress:!0}};Object(b["a"])(this,t),this._gid=i,this._id=o,this._name=s.name,this._parentNode=r,this._children=s.children,this._collapsed=!0===(null===s||void 0===s?void 0:s.collapsed),this._depth=a,this._editing=!!s.firstEdit&&null!==r,this._firstEdit=s.firstEdit,this._emoji=s.emoji||[],this._done=s.done,this._weight=s.weight||1,this._virtualChildrenAmount=s.virtualChildren||0,this._virtualFinishedChildrenAmount=s.virtualFinishedChildren||0,this.isRoot=!0===(null===s||void 0===s?void 0:s.isRoot),this.size=[250,250],this._settings={displayProgress:!1!==(null===(e=s.settings)||void 0===e?void 0:e.displayProgress),deepProgress:!1!==(null===(n=s.settings)||void 0===n?void 0:n.deepProgress)}}return Object(y["a"])(t,[{key:"addChild",value:function(e){e instanceof t&&this._children.push(e)}},{key:"addChildAtIndex",value:function(e,n){e instanceof t&&!(n<0)&&this._children.splice(n,0,e)}},{key:"toggleEmoji",value:function(t){this._emoji.includes(t)?this._emoji.splice(this._emoji.indexOf(t),1):this._emoji.push(t)}},{key:"toggleDoneState",value:function(){this._done=!this._done}},{key:"getChildren",value:function(){return this._children}},{key:"setAllChildrenDoneState",value:function(t){this._children.forEach((function(e){return e.done=!!t}))}},{key:"delete",value:function(){var t=this._parentNode._children.indexOf(this);this._parentNode.children.splice(t,1)}},{key:"setSetting",value:function(t,e){void 0!==this._settings[t]&&(this._settings[t]=e)}},{key:"toggleSetting",value:function(t){void 0!==this._settings[t]&&"boolean"===typeof this._settings[t]&&this.setSetting(t,!this._settings[t])}},{key:"parseName",value:function(){this._name=this._name.trim();var t=this._name.match(/\s\d+$/gm),e=this._name.match(/\s\d+\/\d+/gm);if(null!==t&&void 0!==t&&t.length)this._weight=parseInt(t[0]),this._virtualChildrenAmount=0,this._virtualFinishedChildrenAmount=0;else if(null!==e&&void 0!==e&&e.length){var n=e[0].split("/");if(2===n.length){var i=parseInt(n[0]),o=parseInt(n[1]);i<=o&&(this._virtualFinishedChildrenAmount=i,this._virtualChildrenAmount=o)}this._name=this._name.slice(0,-e[0].length)}}},{key:"export",value:function(){return t(this);function t(n){var i,o={name:n.name,children:null!==(i=n.getChildren())&&void 0!==i&&i.length?n.getChildren().map((function(n){if(n.getChildren().length)return t(n);var i={name:n.name};return e(i,n),i})):[]};return e(o,n),o}function e(t,e){var n;e.collapsed&&(t.collapsed=!0),e.done&&(t.done=!0),null!==(n=e.emoji)&&void 0!==n&&n.length&&(t.emoji=e.emoji),e.weight>1&&(t.weight=e.weight),e._virtualChildrenAmount>0&&(t.virtualChildren=e._virtualChildrenAmount),e._virtualFinishedChildrenAmount>0&&(t.virtualFinishedChildren=e._virtualFinishedChildrenAmount),JSON.stringify(e.settings)!==JSON.stringify(j)&&(t.settings={},Object.entries(e.settings).forEach((function(e){var n=Object(c["a"])(e,2),i=n[0],o=n[1];o!==j[i]&&(t.settings[i]=o)})))}}},{key:"addWeight",value:function(t){"number"===typeof t&&this._weight+t>0?this._weight+=t:this._weight=1}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"parent",get:function(){return this._parentNode},set:function(t){this._parentNode=t}},{key:"children",get:function(){return this.collapsed?[]:this._children},set:function(t){this._children=t}},{key:"collapsed",get:function(){return this._collapsed},set:function(t){this._children.length&&(this._collapsed=t)}},{key:"name",get:function(){return this._name||"node #".concat(this._gid)},set:function(t){this._name=t,this.editing=!1}},{key:"editing",get:function(){return this._editing},set:function(t){this._editing=t,this._firstEdit&&!1===t&&(this._firstEdit=!1)}},{key:"depth",get:function(){return this._depth}},{key:"childrenLength",get:function(){return this._children.length}},{key:"totalChildrenTasks",get:function(){if(this._virtualChildrenAmount>0)return this._virtualChildrenAmount;var t=0;return this._children.forEach((function(e){t+=1,e._virtualChildrenAmount>0?t+=e._virtualChildrenAmount:e._children.length&&(t+=e.totalChildrenTasks)})),t}},{key:"finishedChildrenTasks",get:function(){if(this._virtualFinishedChildrenAmount>0)return this._virtualFinishedChildrenAmount;if(this._children.length){var t=0;return this._children.forEach((function(e){t+=e.done?1:0,e._virtualFinishedChildrenAmount>0?t+=e._virtualFinishedChildrenAmount:e._children.length&&(t+=e.finishedChildrenTasks)})),t}return 0}},{key:"firstEdit",get:function(){return this._firstEdit}},{key:"emoji",get:function(){return this._emoji}},{key:"done",get:function(){return this._done},set:function(t){this._done=!!t}},{key:"progress",get:function(){var t=this._settings.deepProgress?this.deepProgress:this.shallowProgress,e=t.percentage;return e}},{key:"deepProgress",get:function(){if(this._virtualFinishedChildrenAmount>0){var t=this._virtualFinishedChildrenAmount,e=this._virtualChildrenAmount,n=(t/e*100).toFixed(0);return{sum:t,totalNodes:e,percentage:n}}if(this._children.length){var i=0,o=this._children.reduce((function(t,e){return t+(e.weight||1)}),0);return this._children.forEach((function(t){if(i+=t.done?t.weight||1:0,t._virtualChildrenAmount>0)i+=t._virtualFinishedChildrenAmount,o+=t._virtualChildrenAmount;else if(t._children.length){var e=t.deepProgress,n=e.sum,r=e.totalNodes;i+=n,o+=r}})),{sum:i,totalNodes:o,percentage:(i/o*100).toFixed(0)}}return{sum:0,totalNodes:0,percentage:0}}},{key:"shallowProgress",get:function(){if(this._virtualFinishedChildrenAmount>0){var t=this._virtualFinishedChildrenAmount,e=this._virtualChildrenAmount,n=(t/e*100).toFixed(0);return{sum:t,totalNodes:e,percentage:n}}if(this._children.length){var i=0,o=this._children.reduce((function(t,e){return t+(e.weight||1)}),0);return this._children.forEach((function(t){return i+=t.done?t.weight||1:0})),{sum:i,totalNodes:o,percentage:(i/o*100).toFixed(0)}}return{sum:0,totalNodes:0,percentage:0}}},{key:"settings",get:function(){return this._settings}},{key:"canDrillDown",get:function(){return!this.isRoot}},{key:"canDrillUp",get:function(){return this.isRoot&&null!=this._parentNode}},{key:"collapsible",get:function(){return!this._collapsed&&this.childrenLength>0}},{key:"expandable",get:function(){return this._collapsed}},{key:"draggable",get:function(){return!this.isRoot}},{key:"deletable",get:function(){return!this.isRoot}},{key:"weight",get:function(){return this._weight},set:function(t){"number"===typeof t&&(this._weight=t)}}]),t}(),O=function(){function t(){var e=this;Object(b["a"])(this,t),this._gidCounter=1,this._root=new T(0,0,null,0,{name:"root",isRoot:!0}),this.lastNode=this._root,this._query=[],this.loaded=!1,D.dispatch("getTreeData").then((function(t){e.parseTreeData(t),e.loaded=!0}))}return Object(y["a"])(t,[{key:"addSibling",value:function(){var t=this.createNode(this.lastNodeID,this.lastNodeParent?this.lastNodeParent:this._root,this._lastNode.depth||1);this.lastNodeParent?this.pushNode(this.lastNodeParent.children,t):this.pushNode(this._root.children,t),this.lastNode=t}},{key:"addChild",value:function(){var t=this._lastNode?this._lastNode.children.length:this.lastNodeID,e=this.createNode(t,this._lastNode,(this._lastNode.depth||0)+1);this._lastNode?this.pushNode(this._lastNode.children,e):this.pushNode(this._root,e),this.lastNode=e,this.lastNodeParent.collapsed=!1}},{key:"pushNode",value:function(t,e){t.push(e)}},{key:"createNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return new T(this.counter,t,e,n)}},{key:"deleteLastNode",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{force:!1};if(!this._lastNode.editing&&this.lastNodeParent||n.force){var i=null;i=this._lastNode.id-1>=0?this.lastNodeParent.children[this._lastNode.id-1]:null!==(t=this.lastNodeParent)&&void 0!==t&&null!==(e=t.parent)&&void 0!==e&&e.children?this.lastNodeParent.parent.children[this.lastNodeParent.parent.children.length-1]:this.lastNodeParent,this.lastNodeParent.children.splice(this._lastNode.id,1),this.lastNode=i}}},{key:"collapseLastNode",value:function(){this._lastNode.editing||(this._lastNode.collapsed=!this._lastNode.collapsed)}},{key:"blurLastNode",value:function(t){t&&this._lastNode._gid===t._gid&&(this._lastNode._firstEdit?this.deleteLastNode({force:!0}):this._lastNode.editing=!1)}},{key:"goUp",value:function(){var t;if(!this._lastNode.editing)if(this._lastNode.id-1>=0)this.lastNode=this.lastNodeParent.children[this._lastNode.id-1];else if((null===(t=this.lastNodeParent)||void 0===t?void 0:t.id)>0&&this.lastNodeParent.parent){for(var e,n=this.lastNodeParent.id-1;n>=0;n--)if(this.lastNodeParent.parent.children[n].children.length){e=this.lastNodeParent.parent.children[n];break}e&&(this.lastNode=e.children[e.children.length-1])}}},{key:"goDown",value:function(){if(!this._lastNode.editing&&this.lastNodeParent)if(this._lastNode.id+1<this.lastNodeParent.children.length)this.lastNode=this.lastNodeParent.children[this._lastNode.id+1];else if(this.lastNodeParent.parent&&this.lastNodeParent.id<this.lastNodeParent.parent.children.length){for(var t,e=this.lastNodeParent.id+1;e<this.lastNodeParent.parent.children.length;e++)if(this.lastNodeParent.parent.children[e].children.length){t=this.lastNodeParent.parent.children[e];break}t&&(this.lastNode=t.children[0])}}},{key:"goLeft",value:function(){var t,e;this._lastNode.editing||null!==(t=this._lastNode)&&void 0!==t&&null!==(e=t.parent)&&void 0!==e&&e.parent&&(this.lastNode=this._lastNode.parent)}},{key:"goRight",value:function(){if(!this._lastNode.editing&&this._lastNode&&this._lastNode.children.length){var t=Math.floor(this._lastNode.children.length/2);this.lastNode=this._lastNode.children[t]}}},{key:"getChildren",value:function(){return this._root._children}},{key:"cloneNode",value:function(t,e,n){var i=this;function o(t,e){var n=new T(i.counter,t.id,e,t.depth,E(t));return n.children=t.getChildren().map((function(t){return o(t,n)})),n}var r=o(t,"bottom"===n||"top"===n?e.parent:e);if(t.delete(),n&&"right"!==n)if(n&&"top"!==n){if(n&&"bottom"!==n)return;e.parent.addChildAtIndex(r,e.parent._children.indexOf(e)+1)}else e.parent.addChildAtIndex(r,e.parent._children.indexOf(e));else e.addChild(r);this.lastNode=r}},{key:"export",value:function(){var t=this._query.length?this._query[0]:this._root;return t.export()}},{key:"import",value:function(t){var e;if(null!==t&&void 0!==t&&null!==(e=t.children)&&void 0!==e&&e.length){var n,i=this,o=Object(m["a"])(t.children);try{for(o.s();!(n=o.n()).done;){var r=n.value;a(r,this.lastNode)}}catch(c){o.e(c)}finally{o.f()}}function a(t,e){var n,o=new T(i.counter,e.children.length,e,e.depth+1||0,E(t));o.children=null!==(n=t.children)&&void 0!==n&&n.length?s(t,o):[],e.children.push(o)}function s(t,e){var n;return null===t||void 0===t||null===(n=t.children)||void 0===n?void 0:n.map((function(t,n){var o,r=new T(i.counter,n,e,e.depth+1,E(t));return r.children=null!==(o=t.children)&&void 0!==o&&o.length?s(t,r):[],r}))}}},{key:"parseTreeData",value:function(t){if(t){var e=this;if(this._root.name=t.name?t.name:"root",this._root.children=[],this._lastNode=this._root,this._gidCounter=1,t.children){var n,i=Object(m["a"])(t.children);try{for(i.s();!(n=i.n()).done;){var o=n.value;r(o,this._root)}}catch(s){i.e(s)}finally{i.f()}}}function r(t,n){var i,o=new T(e.counter,n.children.length,n,n.depth+1||0,E(t));o.children=null!==(i=t.children)&&void 0!==i&&i.length?a(t,o):[],n.children.push(o)}function a(t,n){var i;return null===t||void 0===t||null===(i=t.children)||void 0===i?void 0:i.map((function(t,i){var o,r=new T(e.counter,i,n,n.depth+1,E(t));return r.children=null!==(o=t.children)&&void 0!==o&&o.length?a(t,r):[],r}))}}},{key:"spliceRootsQuery",value:function(t){if(!(t<=0||t>this._query.length)){t>1&&(this._query=this._query.slice(0,-(t-1)));var e=this._query.pop();this._root.isRoot=!1,e.isRoot=!0,this._root=e}}},{key:"pushRootToQuery",value:function(t){t&&t instanceof T&&(this._query.push(this._root),t.collapsed=!1,this._root.isRoot=!1,t.isRoot=!0,this._root=t)}},{key:"sortLastNode",value:function(t,e){console.log(t,e),this.lastNode._children.sort((function(t,e){return t.name<e.name?-1:1}))}},{key:"lastNodeID",get:function(){return this.lastNodeParent?this.lastNodeParent.children.length:this._root.children.length}},{key:"lastNode",get:function(){return this._lastNode},set:function(t){var e;if(!(t instanceof T))return null!==t&&void 0!==t&&t._root?null:console.error("".concat(t," is not instance of Node"));this._lastNode!==t&&(null!==this&&void 0!==this&&null!==(e=this._lastNode)&&void 0!==e&&e.editing&&(this._lastNode.editing=!1),this._lastNode=t)}},{key:"lastNodeParent",get:function(){var t;return(null===(t=this._lastNode)||void 0===t?void 0:t.parent)||null}},{key:"counter",get:function(){return this._gidCounter++}},{key:"root",get:function(){return this._root}},{key:"query",get:function(){return this._query}},{key:"hasQuery",get:function(){var t;return(null===(t=this._query)||void 0===t?void 0:t.length)>0}}]),t}();function E(t){return Object.assign({},{name:t.name,firstEdit:t.firstEdit||!1,collapsed:t.collapsed||!1,emoji:t.emoji,done:t.done,weight:t.weight||1,virtualChildren:t.virtualChildren,virtualFinishedChildren:t.virtualFinishedChildren,settings:t.settings})}var S=new O,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabs-component"},[n("ul",{staticClass:"tabs-component-tabs",attrs:{role:"tablist"}},t._l(t.tabs,(function(e,i){return n("li",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"tab.isVisible"}],key:i,staticClass:"tabs-component-tab",class:{active:e.isActive,disabled:e.isDisabled},attrs:{role:"presentation"},on:{click:function(n){return t.selectTab(e.hash,n)}}},[n("span",{staticClass:"tabs-component-tab-a",attrs:{"aria-controls":e.hash,"aria-selected":e.isActive,href:e.hash,role:"tab"},domProps:{innerHTML:t._s(e.header)}})])})),0),n("div",{staticClass:"tabs-component-panels"},[t._t("default")],2)])},P=[],A=(n("7db0"),{props:{cacheLifetime:{default:5},options:{type:Object,required:!1,default:function(){return{useUrlFragment:!0,defaultTabHash:null}}}},data:function(){return{tabs:[],activeTabHash:"",activeTabIndex:0,lastActiveTabHash:""}},computed:{storageKey:function(){return"vue-tabs-component.cache.".concat(window.location.host).concat(window.location.pathname)}},created:function(){this.tabs=this.$children},mounted:function(){var t=this;if(window.addEventListener("hashchange",(function(){return t.selectTab(window.location.hash)})),this.findTab(window.location.hash))this.selectTab(window.location.hash);else{var e="";this.findTab(e)?this.selectTab(e):null!==this.options.defaultTabHash&&this.findTab("#"+this.options.defaultTabHash)?this.selectTab("#"+this.options.defaultTabHash):this.tabs.length&&this.selectTab(this.tabs[0].hash)}},methods:{findTab:function(t){return this.tabs.find((function(e){return e.hash===t}))},selectTab:function(t,e){e&&!this.options.useUrlFragment&&e.preventDefault();var n=this.findTab(t);n&&(n.isDisabled?e.preventDefault():this.lastActiveTabHash!==n.hash?(this.tabs.forEach((function(t){t.isActive=t.hash===n.hash})),this.$emit("changed",{tab:n}),this.activeTabHash=n.hash,this.activeTabIndex=this.getTabIndex(t),this.lastActiveTabHash=this.activeTabHash=n.hash):this.$emit("clicked",{tab:n}))},setTabVisible:function(t,e){var n=this.findTab(t);n&&(n.isVisible=e,n.isActive&&(n.isActive=e,this.tabs.every((function(t){return!t.isVisible||(t.isActive=!0,!1)}))))},getTabIndex:function(t){var e=this.findTab(t);return this.tabs.indexOf(e)},getTabHash:function(t){var e=this,n=this.tabs.find((function(n){return e.tabs.indexOf(n)===t}));if(n)return n.hash},getActiveTab:function(){return this.findTab(this.activeTabHash)},getActiveTabIndex:function(){return this.getTabIndex(this.activeTabHash)}}}),$=A,L=(n("2ff8"),n("2877")),F=Object(L["a"])($,I,P,!1,null,"0d195260",null),G=F.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"tabs-component-panel",attrs:{"aria-hidden":!t.isActive,id:t.computedId,role:"tabpanel"}},[t._t("default")],2)},M=[],q={props:{id:{default:null},name:{required:!0},prefix:{default:""},suffix:{default:""},isDisabled:{default:!1}},data:function(){return{isActive:!1,isVisible:!0}},computed:{header:function(){return this.prefix+this.name+this.suffix},computedId:function(){return this.id?this.id:this.name.toLowerCase().replace(/ /g,"-")},hash:function(){return this.isDisabled?"#":"#"+this.computedId}}},H=q,U=Object(L["a"])(H,R,M,!1,null,null,null),B=U.exports,J={name:"ImportJSON",components:{Tabs:G,Tab:B},data:function(){return{file:null,importToSelectedNode:!1}},methods:{fileChange:function(){var t;if(this.file=this.$refs.file.files[0],this.file)return"application/json"!==(null===(t=this.file)||void 0===t?void 0:t.type)?(this.file=null,alert("Improted file should have .json extension")):void 0},importFromFile:function(){var t=this;if(this.file){var e=new FileReader;e.onload=function(e){var n;null!==(n=e.target)&&void 0!==n&&n.result&&(S.import(JSON.parse(e.target.result)),t.$modal.hide("import-export-modal"))},e.readAsText(this.file)}},importFromClipboard:function(){var t=this;navigator.clipboard.readText().then((function(e){S.import(JSON.parse(e)),t.$modal.hide("import-export-modal")})).catch((function(t){alert("Failed to import from clipboard\nYou see this error either becuase there Clipboard permission is not granted,\nor clipboard content is not a valid JSON",t)}))}}},Y=J,K=(n("d92b"),Object(L["a"])(Y,g,v,!1,null,"726764da",null)),W=K.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("tabs",[n("tab",{attrs:{name:"Show In New Tab"}},[n("div",{staticClass:"export-tab"},[n("div",{staticClass:"checkbox",class:{checked:t.exportSelectedNode}},[n("label",{staticClass:"checkbox-label",attrs:{for:"export-selected-new-tab"}},[t._v("Export from selected node")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.exportSelectedNode,expression:"exportSelectedNode"}],attrs:{type:"checkbox",id:"export-selected-new-tab"},domProps:{checked:Array.isArray(t.exportSelectedNode)?t._i(t.exportSelectedNode,null)>-1:t.exportSelectedNode},on:{change:function(e){var n=t.exportSelectedNode,i=e.target,o=!!i.checked;if(Array.isArray(n)){var r=null,a=t._i(n,r);i.checked?a<0&&(t.exportSelectedNode=n.concat([r])):a>-1&&(t.exportSelectedNode=n.slice(0,a).concat(n.slice(a+1)))}else t.exportSelectedNode=o}}})]),n("div",{staticClass:"export-button"},[n("button",{on:{click:t.showInNewTab}},[t._v("Export")])])])]),n("tab",{attrs:{name:"Download File"}},[n("div",{staticClass:"export-tab"},[n("div",{staticClass:"row"},[n("span",{staticClass:"name-input"},[n("label",{attrs:{for:"export-file-name"}},[t._v("Filename")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.filename,expression:"filename"}],attrs:{id:"export-file-name",type:"text",placeholder:t.defaultFilename},domProps:{value:t.filename},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.filename=e.target.value)}}})]),n("div",{staticClass:"checkbox",class:{checked:t.exportSelectedNode}},[n("label",{staticClass:"checkbox-label",attrs:{for:"export-selected-download"}},[t._v("Export from selected node")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.exportSelectedNode,expression:"exportSelectedNode"}],attrs:{type:"checkbox",id:"export-selected-download"},domProps:{checked:Array.isArray(t.exportSelectedNode)?t._i(t.exportSelectedNode,null)>-1:t.exportSelectedNode},on:{change:function(e){var n=t.exportSelectedNode,i=e.target,o=!!i.checked;if(Array.isArray(n)){var r=null,a=t._i(n,r);i.checked?a<0&&(t.exportSelectedNode=n.concat([r])):a>-1&&(t.exportSelectedNode=n.slice(0,a).concat(n.slice(a+1)))}else t.exportSelectedNode=o}}})])]),n("div",{staticClass:"export-button"},[n("button",{on:{click:t.downloadFile}},[t._v("Export")])])])])],1)],1)},Q=[],V=(n("2b3d"),{name:"ExportJSON",components:{Tabs:G,Tab:B},data:function(){return{exportSelectedNode:!1,filename:"",defaultFilename:"tree-data"}},methods:{stringifiedTree:function(){return JSON.stringify(this.exportSelectedNode?S.lastNode.export():S.export(),null,"  ")},showInNewTab:function(){var t=this.stringifiedTree(),e=window.open("about:blank","_blank");e.document.write("<pre>".concat(t,"</pre>")),e.document.close()},downloadFile:function(){var t=this.stringifiedTree(),e=new Blob([t],{type:"application/json"}),n=document.createElement("a");n.download="".concat(this.filename||this.defaultFilename,".json"),n.href=(window.webkitURL||window.URL).createObjectURL(e),n.dataset.downloadurl=["application/json",n.download,n.href].join(":"),n.click()}}}),z=V,Z=(n("0db9"),Object(L["a"])(z,X,Q,!1,null,"a7b00144",null)),tt=Z.exports,et={name:"ImportExportModal",components:{ImportJSON:W,ExportJSON:tt},data:function(){return{currTab:""}},methods:{beforeOpen:function(t){this.currTab=t.params}}},nt=et,it=(n("ec80"),Object(L["a"])(nt,f,p,!1,null,"8c80905c",null)),ot=it.exports,rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("modal",{attrs:{name:"docs-modal",adaptive:!0,height:"auto",width:"30%"},on:{"before-close":t.beforeClose}},[n("div",{staticClass:"doc-menu"},[n("div",{staticClass:"buttons"},[n("button",{staticClass:"doc-new",on:{click:t.createNewDocument}},[n("b-icon",{attrs:{icon:"file-earmark-plus"}})],1)]),n("div",{staticClass:"doc-list"},t._l(t.documents,(function(e,i){return n("div",{key:i,staticClass:"doc",class:{active:t.activeDoc(i)},on:{click:function(e){return t.setDocument(i)}}},[i!==t.editingDoc?n("div",{staticClass:"content"},[n("span",{staticClass:"doc-name"},[t._v(t._s(e.name))]),n("span",[e.lastEdit?n("span",{staticClass:"doc-date"},[t._v(t._s(t.timeAgo(e.lastEdit)))]):t._e(),n("button",{on:{click:function(n){return n.stopPropagation(),t.enterDocEdit(e,i)}}},[n("b-icon",{attrs:{icon:"pencil-square"}})],1),n("button",{on:{click:function(e){return e.stopPropagation(),t.deleteDocument(i)}}},[n("b-icon",{attrs:{icon:"trash"}})],1)])]):n("div",{staticClass:"content"},[n("div",{staticClass:"name-input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newDocName,expression:"newDocName"}],ref:"docNameInput",refInFor:!0,attrs:{type:"text"},domProps:{value:t.newDocName},on:{click:function(t){t.stopPropagation()},keydown:[function(t){t.stopPropagation()},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.saveDocName(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.leaveDocEdit()}],mousewheel:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.newDocName=e.target.value)}}})]),n("div",[n("button",{on:{click:function(n){return t.leaveDocEdit(e)}}},[n("b-icon",{attrs:{icon:"x"}})],1),n("button",{on:{click:function(n){return t.saveDocName(e)}}},[n("b-icon",{attrs:{icon:"check2"}})],1)])])])})),0)])])},at=[],st={name:"DocumentsList",data:function(){return{store:D,newDocName:"",editingDoc:"",currTab:""}},computed:{documents:function(){return D.state.documents}},methods:Object(l["a"])(Object(l["a"])({},Object(k["b"])({setDocumentAction:"setDocument",createDocumentAction:"createDocument",deleteDocumentAction:"deleteDocument"})),{},{setDocument:function(t){this.setDocumentAction(t).then((function(t){return S.parseTreeData(t)}))},createNewDocument:function(){this.createDocumentAction().then((function(t){return S.parseTreeData(t)}))},enterDocEdit:function(t,e){var n=this;this.newDocName=t.name,this.editingDoc=e,this.$nextTick((function(){n.$refs.docNameInput&&n.$refs.docNameInput[0]&&n.$refs.docNameInput[0].focus()}))},leaveDocEdit:function(){this.newDocName="",this.editingDoc=""},saveDocName:function(t){t.name=this.newDocName,this.leaveDocEdit()},deleteDocument:function(t){var e=this;this.deleteDocumentAction(t).then((function(n){e.activeDoc(t)||S.parseTreeData(n)}))},activeDoc:function(t){return t===D.state.settings.lastDocument},beforeClose:function(){this.newDocName="",this.editingDoc=""},timeAgo:function(t){var e=new Date(t),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return"".concat(e.getHours(),":").concat(e.getMinutes()," ").concat(e.getDate()," ").concat(n[e.getMonth()])}})},ct=st,dt=(n("5f94"),Object(L["a"])(ct,rt,at,!1,null,"fdd9583a",null)),lt=dt.exports,ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"}],staticClass:"bar"},[n("div",{staticClass:"title"},[n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],attrs:{type:"text"},domProps:{value:t.searchInput},on:{keydown:function(t){t.stopPropagation()},mousewheel:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.searchInput=e.target.value)}}}),n("span",{staticClass:"input-icon"},[n("b-icon",{attrs:{"shift-v":"4",icon:"search"}})],1)]),n("button",{on:{click:t.close}},[n("b-icon",{attrs:{"shift-v":"4",icon:"x"}})],1)]),t.favorites.length?n("div",{staticClass:"favorites-list"},[n("span",{staticClass:"title"},[t._v("Favorites:")]),n("div",{staticClass:"flex-wrapper"},t._l(t.favorites,(function(e){return n("div",{key:e.key},[n("div",{staticClass:"emoji",class:{selected:t.isSelected(e.key)},attrs:{title:e.key},domProps:{textContent:t._s(e.emoji)},on:{click:function(n){return t.toggleEmoji(e.key)},contextmenu:function(n){return n.preventDefault(),t.toggleFavorite(e.key)}}})])})),0),n("hr")]):t._e(),t.currentNodeEmoji.length?n("div",{staticClass:"favorites-list"},[n("span",{staticClass:"title"},[t._v("Current node:")]),n("div",{staticClass:"flex-wrapper"},t._l(t.currentNodeEmoji,(function(e){return n("div",{key:e.key},[n("div",{staticClass:"emoji",attrs:{title:e.key},domProps:{textContent:t._s(e.emoji)},on:{click:function(n){return t.toggleEmoji(e.key)},contextmenu:function(n){return n.preventDefault(),t.toggleFavorite(e.key)}}})])})),0),n("hr")]):t._e(),t.searchInput?n("div",{staticClass:"emoji-list"},[n("div",{staticClass:"flex-wrapper"},t._l(t.searchResult,(function(e){return n("div",{key:e.key},[n("div",{staticClass:"emoji",class:{selected:t.isSelected(e.key)},attrs:{title:e.key},domProps:{textContent:t._s(e.emoji)},on:{click:function(n){return t.toggleEmoji(e.key)}}})])})),0)]):n("div",{staticClass:"emoji-list"},[n("div",{staticClass:"flex-wrapper"},t._l(t.emojis.emoji,(function(e,i){return n("div",{key:i,staticClass:"emoji",class:{selected:t.isSelected(i)},attrs:{title:i},domProps:{textContent:t._s(e)},on:{click:function(e){return t.toggleEmoji(i)},contextmenu:function(e){return e.preventDefault(),t.toggleFavorite(i)}}})})),0)])])])},ht=[],ft=(n("841c"),n("b90b")),pt=n.n(ft),gt=new i["default"],vt=[{title:"Add Child",icon:"diagram2",event:"tree-add-child",hotkey:"tab",options:{prevent:!0}},{title:"Add Sibling",icon:"node-plus",event:"tree-add-sibling",hotkey:"enter"},{title:"Collapse Node",icon:"arrows-collapse",event:"tree-node-collapse",hotkey:"c"},{title:"Edit Node",icon:"pencil",event:"tree-node-edit",hotkey:"e",options:{prevent:!0}},{title:"Toggle Node Done State",icon:"check2",event:"tree-node-toggle-done",hotkey:"d"},{title:"Delete Node",icon:"trash",event:"tree-delete-last-node",hotkey:["delete","backspace"]},{title:"Cursor Up",event:"tree-go-up",hotkey:"arrowup",UIIgnore:!0},{title:"Cursor Right",event:"tree-go-right",hotkey:"arrowright",UIIgnore:!0},{title:"Cursor Down",event:"tree-go-down",hotkey:"arrowdown",UIIgnore:!0},{title:"Cursor Left",event:"tree-go-left",hotkey:"arrowleft",UIIgnore:!0},{title:"Save Document",event:"document-save",hotkey:"ctrl+s",options:{prevent:!0},UIIgnore:!0}],mt={};function bt(){window.addEventListener("keydown",yt),window.addEventListener("unload",kt);var t,e=Object(m["a"])(vt);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hotkey instanceof Array||(n.hotkey=[n.hotkey]);var i,o=Object(m["a"])(n.hotkey);try{for(o.s();!(i=o.n()).done;){var r=i.value,a=r.toLowerCase();mt[a]?console.error("Multiple hotkeys binding on single event: ".concat(n.event)):mt[a]=n}}catch(s){o.e(s)}finally{o.f()}}}catch(s){e.e(s)}finally{e.f()}}function yt(t){var e=_t(t),n=mt[e];function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{prevent:!1};n.prevent&&t.preventDefault(),gt.$emit(e)}n&&i(n.event,n.options)}function _t(t){var e=[];return t.ctrlKey&&"Control"!==t.key&&e.push("ctrl"),t.altKey&&"Alt"!==t.key&&e.push("alt"),t.shiftKey&&"Shift"!==t.key&&e.push("shift"),e.push(t.key.toLowerCase()),e.join("+")}function kt(){window.removeEventListener("keydown",yt),window.removeEventListener("unload",kt)}var xt={name:"EmojiBar",data:function(){return{emojis:pt.a,tree:S,searchInput:"",shown:!1,favoritesRaw:D.state.favoriteEmojis||[]}},computed:{favorites:function(){return this.favoritesRaw.map((function(t){return pt.a.find(t)}))},currentNodeEmoji:function(){var t,e;return(null===(t=this.tree.lastNode)||void 0===t||null===(e=t.emoji)||void 0===e?void 0:e.map((function(t){return pt.a.find(t)})))||[]},searchResult:function(){return pt.a.search(this.searchInput)}},methods:{toggleEmoji:function(t){t&&gt.$emit("tree-node-toggle-emoji",t)},toggleFavorite:function(t){t&&(this.favorites.some((function(e){return e.key===t}))?this.removeFavorite(t):this.addFavorite(t))},addFavorite:function(t){t&&D.commit("addFavoriteEmoji",t)},removeFavorite:function(t){t&&D.commit("removeFavoriteEmoji",t)},isSelected:function(t){if(t)return this.currentNodeEmoji.some((function(e){return e.key===t}))},toggle:function(){this.shown?this.close():this.open()},close:function(){this.shown=!1},open:function(){this.shown=!0}}},Ct=xt,Nt=(n("d3d5"),Object(L["a"])(Ct,ut,ht,!1,null,null,null)),wt=Nt.exports,Dt={name:"Toolbar",components:{DocumentsList:lt,EmojiBar:wt,ImportExportModal:ot},data:function(){return{tree:S,events:vt,actions:[{title:"Add child",icon:"diagram2",event:"tree-add-child"},{title:"Add sibling",icon:"node-plus",event:"tree-add-sibling"},{title:"Collapse",cond:function(){return S.lastNode.collapsible},icon:"arrows-collapse",event:"tree-node-collapse"},{title:"Expand",cond:function(){return S.lastNode.expandable},icon:"arrows-expand",event:"tree-node-collapse"},{title:"Edit",icon:"pencil",event:"tree-node-edit"},{title:"Drill down",cond:function(){return S.lastNode.canDrillDown},icon:"arrow-bar-down",event:"tree-push-root"},{title:"Drill up",cond:function(){return S.lastNode.canDrillUp},icon:"arrow-bar-up",event:"tree-pop-root"},{title:"Mark done",icon:"check2",event:"tree-node-toggle-done"},{title:"Do all children",cond:function(){return S.lastNode.childrenLength>0},icon:"check2-square",event:"tree-node-do-all-children"},{title:"Undo all children",cond:function(){return S.lastNode.childrenLength>0},icon:"x-square",event:"tree-node-undo-all-children"}]}},methods:Object(l["a"])(Object(l["a"])({},Object(k["d"])(["addCard","deleteAllCards"])),{},{emitEvent:function(t){t&&gt.$emit(t)},condSatisfied:function(t){return!t.cond||("function"===typeof t.cond?t.cond():0!=t.cond)},toggleEmojiBar:function(){var t,e;null===(t=this.$refs)||void 0===t||null===(e=t.emojiBar)||void 0===e||e.toggle()},toggleDocMenu:function(){this.$modal.show("docs-modal")},toggleImportExportModal:function(t){this.$modal.show("import-export-modal",t)},spawnCard:function(t){this.addCard(new N("","",{editing:!0,x:t.clientX,y:t.clientY,dragging:!0}))}})},jt=Dt,Tt=(n("2250"),n("c1c1"),Object(L["a"])(jt,u,h,!1,null,"938189b0",null)),Ot=Tt.exports,Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"breadcrumb-query"},[n("span",t._l(t.query,(function(e,i){return n("span",{key:i},[n("a",{attrs:{href:"#"},on:{click:function(e){return t.popStack(i)}}},[t._v(t._s(e))]),i+1<t.queryLen?n("b-icon",{attrs:{icon:"chevron-right","shift-v":"-1","shift-h":"1"}}):t._e()],1)})),0)])},St=[],It={name:"Breadcrumb",computed:{query:function(){return S.query.map((function(t){return t.name}))},queryLen:function(){return S.query.length}},methods:{popStack:function(t){S.spliceRootsQuery(S.query.length-t)}}},Pt=It,At=(n("28e0"),Object(L["a"])(Pt,Et,St,!1,null,null,null)),$t=At.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"},{name:"on-clickaway",rawName:"v-on-clickaway:mousedown",value:t.close,expression:"close",arg:"mousedown"}],ref:"contextMenu",staticClass:"context-menu",style:t.style,attrs:{tabindex:"0"},on:{click:function(e){return t.close()},contextmenu:function(t){t.preventDefault()}}},[t._t("items")],2)},Ft=[],Gt=n("723b"),Rt={mixins:[Gt["mixin"]],computed:{style:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px")}}},data:function(){return{top:0,left:0,shown:!1}},methods:{open:function(t){var e,n,i,o,r=this;if(t){var a=t.pageY||t.clientY,s=t.pageX||t.clientX,c=(null===(e=this.$refs)||void 0===e||null===(n=e.contextMenu)||void 0===n?void 0:n.clientHeight)||170,d=(null===(i=this.$refs)||void 0===i||null===(o=i.contextMenu)||void 0===o?void 0:o.clientWidth)||0,l=a,u=l+c,h=s,f=h+d;Math.max(u,window.innerHeight)===u&&(l-=c),Math.max(f,.5*window.innerWidth)===f&&(h-=d),this.top=l,this.left=h,this.$nextTick((function(){return r.$el.focus()})),this.shown=!0}},close:function(){this.shown&&(this.shown=!1,this.$emit("close-event"),this.left=0,this.top=0)}}},Mt=Rt,qt=(n("716f"),Object(L["a"])(Mt,Lt,Ft,!1,null,"d1b84f7e",null)),Ht=qt.exports,Ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cards-wrapper"},[n("div",{staticClass:"cards"},[n("emoji-picker",{ref:"picker",on:{pick:t.emojiPick}}),t._l(t.cardGroups,(function(e){return n("card-group",{key:e.id,attrs:{group:e,boundaries:t.boundaries,targetGroup:t.targetGroup,draggingCard:t.draggingCard},on:{"set-dragging-card":t.setDraggingCard,"set-target-group":t.setTargetGroup,"open-picker":t.openPicker,"close-picker":t.closePicker}})})),t._l(t.cards,(function(e){return n("card",{key:e.id,attrs:{card:e,targetGroup:t.targetGroup,boundaries:t.boundaries},on:{"set-dragging-card":t.setDraggingCard,"set-target-group":t.setTargetGroup,"open-picker":t.openPicker,"close-picker":t.closePicker}})}))],2)])},Bt=[],Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:t.clickOutside,expression:"clickOutside"}],staticClass:"card-container",class:{"on-top":t.card.focused},style:{top:t.card.y+"px",left:t.card.x+"px",position:t.isChild?"static":"absolute","pointer-events":t.card.noPointerEvents?"none":"auto"},on:{mousedown:t.dragStart,click:function(e){return t.focusCard(!0)}}},[n("div",{staticClass:"card-overlay"},[n("div",{ref:"card",staticClass:"playing-card"},[n("div",{staticClass:"text"},[n("div",{staticClass:"icon",on:{click:function(e){return e.preventDefault(),t.$emit("open-picker",[e,t.card.id])},mouseover:function(e){t.iconHover=!0},mouseleave:function(e){t.iconHover=!1}}},[!t.card.icon&&t.iconHover?n("b-icon",{attrs:{icon:"pencil",scale:"0.8"}}):t._e(),t._v(" "+t._s(t.card.icon)+" ")],1),t.card.editing?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.card.text,expression:"card.text"}],ref:"textarea",attrs:{placeholder:"Card text...",rows:"3"},domProps:{value:t.card.text},on:{click:t.focus,mousedown:function(t){t.stopPropagation()},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),void(t.card.editing=!1))},function(t){t.stopPropagation()}],input:function(e){e.target.composing||t.$set(t.card,"text",e.target.value)}}}):n("span",{domProps:{textContent:t._s(t.card.text)}})])]),t.card.focused?n("div",{staticClass:"controls"},[n("button",{on:{click:function(e){return t.deleteCard(t.card.id)}}},[n("b-icon",{attrs:{icon:"x",scale:"0.7"}})],1),n("button",{on:{click:t.edit}},[n("b-icon",{attrs:{icon:"pencil",scale:"0.7"}})],1),n("button",{on:{click:t.group}},[n("b-icon",{attrs:{icon:"grid",scale:"0.7"}})],1)]):t._e()])])},Yt=[],Kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(b["a"])(this,t),this.id=C(),this.cards=i,this.x=e,this.y=n,this.collapsed=o}return Object(y["a"])(t,[{key:"addCard",value:function(t){this.cards.push(t)}},{key:"deleteCard",value:function(t){var e=this.cards.findIndex((function(e){return e.id===t}));e<0||this.cards.splice(e,1)}}]),t}(),Wt={mixins:[Gt["mixin"]],props:{card:{required:!0},targetGroup:{default:null},boundaries:{default:null}},computed:{isChild:function(){return!!this.card.group}},watch:{boundaries:function(t){var e,n;if(!this.isChild){this.oldBounds||(this.oldBounds=t);var i=((null===t||void 0===t?void 0:t.width)||0)-((null===(e=this.oldBounds)||void 0===e?void 0:e.width)||0),o=((null===t||void 0===t?void 0:t.height)||0)-((null===(n=this.oldBounds)||void 0===n?void 0:n.height)||0),r=this.card.x+i,a=this.card.y+o;r>=0&&r<=t.width&&(this.card.x=r),a>=0&&a<=t.height&&(this.card.y=a),this.oldBounds=t}}},data:function(){return{shift:{x:0,y:0},origin:{x:0,y:0},cardClone:null,dragging:!1,iconHover:!1,oldBounds:null,cardWidth:120,cardHeight:170}},created:function(){window.addEventListener("mousemove",this.drag),window.addEventListener("mouseup",this.dragEnd)},methods:Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(k["d"])(["addCard","setCardDProperty","createGroup","deleteCard"])),Object(k["b"])(["addCardToGroup"])),{},{dragStart:function(t){var e=this.$refs.card.getBoundingClientRect();this.shift.x=t.clientX-e.left,this.shift.y=t.clientY-e.top,this.origin.x=e.left,this.origin.y=e.top,this.dragging=!0,this.$emit("set-dragging-card",!0)},drag:function(t){if(this.dragging){var e=t.clientX-this.shift.x,n=t.clientY-this.shift.y;this.isChild&&(Math.abs(this.origin.x-e)>100||Math.abs(this.origin.y-n)>100)&&this.ungroup(),e>0&&this.inbound("width",e)&&(this.card.x=e),n>0&&this.inbound("height",n)&&(this.card.y=n),this.card.noPointerEvents=!0}},dragEnd:function(){this.dragging&&(this.targetGroup&&this.addCardToGroup({cardID:this.card.id,groupID:this.targetGroup}),this.dragging=!1,this.card.noPointerEvents=!1,this.$emit("set-target-group",null),this.$emit("set-dragging-card",!1))},inbound:function(t,e){return!this.boundaries||e+this.cardWidth<=this.boundaries[t]},focus:function(){var t=this;this.$nextTick((function(){return t.$refs.textarea.focus()}))},focusCard:function(t){this.card.focused=!!t},edit:function(){this.card.editing=!this.card.editing,this.card.editing&&this.$nextTick(this.focus)},clickOutside:function(){this.focusCard(!1),this.$emit("close-picker",this.card.id)},group:function(){var t=new Kt(this.card.x,this.card.y,[this.card.id]);this.createGroup(t),this.addCardToGroup({cardID:this.card.id,groupID:t.id})},ungroup:function(){this.$set(this.card,"group",null)}})},Xt=Wt,Qt=(n("638b"),Object(L["a"])(Xt,Jt,Yt,!1,null,"3c2682f0",null)),Vt=Qt.exports,zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-group",style:{top:t.group.y+"px",left:t.group.x+"px"},on:{mouseenter:t.hover,mouseleave:t.unhover}},[n("div",{staticClass:"container"},[n("div",{staticClass:"controls"},[n("div",[n("b-icon",{attrs:{icon:"x"},on:{click:function(e){return t.deleteGroup(t.group.id)}}})],1),t.cards.length>1?n("div",{class:{active:t.orderMode},on:{click:function(e){t.orderMode=!t.orderMode}}},[n("b-icon",{attrs:{icon:"arrow-left-right"}})],1):t._e(),n("div",{class:{active:t.dragging},on:{mousedown:t.dragStart}},[n("b-icon",{attrs:{icon:"arrows-move"}})],1)]),n("draggable",{staticClass:"cards",class:{target:t.isTarget},attrs:{handle:".handle",animation:"200"},on:{change:t.change},model:{value:t.cards,callback:function(e){t.cards=e},expression:"cards"}},t._l(t.cards,(function(e){return n("div",{key:e.id,staticClass:"card-wrapper"},[t.orderMode?n("div",{staticClass:"handle"},[n("b-icon",{attrs:{icon:"grip-horizontal",scale:"1"}})],1):t._e(),n("card",{attrs:{card:e,targetGroup:t.targetGroup},on:{"open-picker":t.openPicker,"close-picker":t.closePicker,"set-dragging-card":function(e){return t.$emit("set-dragging-card",e)}}})],1)})),0)],1)])},Zt=[],te=n("b76a"),ee=n.n(te),ne={props:{group:{required:!0},targetGroup:{default:null},draggingCard:{default:!1},boundaries:{default:null}},components:{draggable:ee.a,Card:Vt},computed:Object(l["a"])(Object(l["a"])({},Object(k["c"])(["groupedCards"])),{},{cards:{get:function(){var t=this,e=this.groupedCards.filter((function(e){return t.group.id===e.group})).sort((function(t,e){return t.orderInGroup-e.orderInGroup}));return e.length?e:(this.deleteGroup(this.group.id),[])},set:function(){}},isTarget:function(){return this.draggingCard&&this.targetGroup===this.group.id}}),watch:{boundaries:function(t){var e,n;this.oldBounds||(this.oldBounds=t);var i=((null===t||void 0===t?void 0:t.width)||0)-((null===(e=this.oldBounds)||void 0===e?void 0:e.width)||0),o=((null===t||void 0===t?void 0:t.height)||0)-((null===(n=this.oldBounds)||void 0===n?void 0:n.height)||0),r=this.group.x+i,a=this.group.y+o;r>=0&&r<=t.width&&(this.group.x=r),a>=0&&a<=t.height&&(this.group.y=a),this.oldBounds=t}},data:function(){return{dragging:!1,shift:{x:0,y:0},oldBounds:null,orderMode:!1}},mounted:function(){window.addEventListener("mousemove",this.drag),window.addEventListener("mouseup",this.dragStop)},methods:Object(l["a"])(Object(l["a"])({},Object(k["b"])(["changeCardPosition","deleteGroup"])),{},{change:function(t){var e,n=null===t||void 0===t||null===(e=t.moved)||void 0===e?void 0:e.element;n&&this.changeCardPosition({cardID:n.id,groupID:n.group,newIndex:t.moved.newIndex})},hover:function(){this.draggingCard&&this.$emit("set-target-group",this.group.id)},unhover:function(){this.draggingCard&&this.$emit("set-target-group",null)},dragStart:function(t){this.dragging=!0;var e=this.$el.getBoundingClientRect();this.shift.x=t.clientX-e.left,this.shift.y=t.clientY-e.top},drag:function(t){if(this.dragging){var e=t.clientX-this.shift.x,n=t.clientY-this.shift.y;e>0&&(this.group.x=e),n>0&&(this.group.y=n)}},dragStop:function(){this.dragging=!1},openPicker:function(t){this.$emit("open-picker",t)},closePicker:function(t){this.$emit("close-picker",t)}})},ie=ne,oe=(n("f7ae"),Object(L["a"])(ie,zt,Zt,!1,null,"a4c2c906",null)),re=oe.exports,ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"}],staticClass:"picker",style:{top:t.y+"px",left:t.x+"px"}},t._l(t.emojis.emoji,(function(e,i){return n("div",{key:i,staticClass:"emoji",attrs:{title:i},domProps:{textContent:t._s(e)},on:{click:function(n){return t.pick({key:i,emoji:e})}}})})),0)},se=[],ce={data:function(){return{emojis:pt.a,shown:!1,x:0,y:0}},methods:{open:function(t){var e=this.$el.getBoundingClientRect(),n=20;this.x=t.clientX+n,this.y=t.clientY-e.height-n,this.shown=!0},close:function(){this.shown=!1},pick:function(t){this.$emit("pick",t)}}},de=ce,le=(n("5cf6"),Object(L["a"])(de,ae,se,!1,null,null,null)),ue=le.exports,he={components:{Card:Vt,EmojiPicker:ue,CardGroup:re},computed:Object(l["a"])(Object(l["a"])({},Object(k["c"])(["cards"])),Object(k["e"])(["cardGroups"])),data:function(){return{target:null,targetGroup:null,draggingCard:!1,boundaries:null}},mounted:function(){this.boundaries=this.$el.getBoundingClientRect(),window.addEventListener("resize",this.align)},methods:Object(l["a"])(Object(l["a"])({},Object(k["d"])(["setCardProperty"])),{},{align:function(){this.boundaries=this.$el.getBoundingClientRect()},setTargetGroup:function(t){this.targetGroup=t},setDraggingCard:function(t){this.draggingCard=t},openPicker:function(t){var e=Object(c["a"])(t,2),n=e[0],i=e[1];this.target=i,this.$refs.picker.open(n)},closePicker:function(t){this.target===t&&(this.$refs.picker.close(),this.target=null)},emojiPick:function(t){this.setCardProperty({cardID:this.target,key:"icon",value:t.emoji})}})},fe=he,pe=(n("ad75"),Object(L["a"])(fe,Ut,Bt,!1,null,"2b171ea2",null)),ge=pe.exports,ve=n("5698"),me=n("5d30"),be=Object(me["a"])(),ye=/translate\((-?\d+)px, ?(-?\d+)px\)/i,_e=/scale\((\S*)\)/i,ke={CURVE:"curve",STRAIGHT:"straight"},xe=200,Ce=100,Ne=200,we=0;function De(){for(var t=[],e="0123456789abcdef",n=0;n<36;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}function je(t){var e=t.x,n=t.y;return{x:n,y:e}}var Te={name:"Tree",props:{config:{type:Object,default:function(){return{nodeWidth:xe,nodeHeight:Ce,nodeMaxWidth:150,nodeMaxHeight:200,levelHeight:Ne}}},linkStyle:{type:String,default:ke.CURVE}},components:{Toolbar:Ot,ContextMenu:Ht,Breadcrumb:$t,CardsWrapper:ge},data:function(){return{d3:ve,events:vt,store:D,tree:S,colors:"568FE1",nodeDataList:[],linkDataList:[],initTransformX:0,initTransformY:0,currentScale:1,nodeDrag:{dragging:!1,source:null,target:null,snap:""},key:0}},computed:{initialTransformStyle:function(){return{transform:"scale(1) translate(".concat(this.initTransformX,"px, ").concat(this.initTransformY,"px)"),transformOrigin:"center"}}},created:function(){var t=this;this.addUniqueKey(this.tree.root),window.addEventListener("unload",this.beforeUnload),gt.$on("tree-push-root",this.pushRootToQuery),gt.$on("tree-pop-root",this.spliceRootsQuery),gt.$on("tree-add-sibling",this.addSibling),gt.$on("tree-add-child",this.addChild),gt.$on("tree-set-last-node",(function(e){e&&e[0]&&t.setLastNode(e[0])})),gt.$on("tree-node-toggle-done",this.toggleDone),gt.$on("tree-node-toggle-emoji",this.toggleEmoji),gt.$on("tree-node-collapse",this.collapseLastNode),gt.$on("tree-node-edit",this.editLastNode),gt.$on("tree-node-do-all-children",this.doAllChildren),gt.$on("tree-node-undo-all-children",this.undoAllChildren),gt.$on("tree-delete-last-node",this.deleteLastNode),gt.$on("tree-go-up",this.goUp),gt.$on("tree-go-down",this.goDown),gt.$on("tree-go-left",this.goLeft),gt.$on("tree-go-right",this.goRight),gt.$on("document-save",this.saveDocument)},mounted:function(){this.init()},methods:Object(l["a"])(Object(l["a"])({},Object(k["b"])({saveDocumentAction:"saveDocument"})),{},{isDraggedOver:function(t){var e,n,i,o;return(null===(e=this.nodeDrag)||void 0===e||null===(n=e.target)||void 0===n?void 0:n.data._gid)===t._gid&&(null===(i=this.nodeDrag)||void 0===i||null===(o=i.source)||void 0===o?void 0:o.data._gid)!==t._gid&&!t.isRoot},startDrag:function(t,e){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",e.data.collapsed=!0,this.nodeDrag.source=e},onDrag:function(){this.nodeDrag.dragging=!0},onDrop:function(t,e){this.nodeDrag.target&&this.nodeDrag.target!==e&&S.cloneNode(e.data,this.nodeDrag.target.data,this.nodeDrag.snap),e.collapsed=!1,this.nodeDrag.dragging=!1,this.nodeDrag.target=null,this.nodeDrag.source=null},mouseOverNode:function(t,e){if(this.nodeDrag.dragging&&!e.isRoot){this.nodeDrag.target=e;var n=t.target.getBoundingClientRect(),i=t.clientX-n.left,o=t.clientY-n.top,r=n.height/2;i>n.width-n.width/4?this.nodeDrag.snap="right":o<r?this.nodeDrag.snap="top":o>=r&&(this.nodeDrag.snap="bottom")}},mouseLeaveNode:function(t,e){var n,i;e.data._gid===(null===(n=this.nodeDrag)||void 0===n||null===(i=n.target)||void 0===i?void 0:i.data._gid)&&(this.nodeDrag.target=null)},beforeUnload:function(){this.saveDocument(),window.removeEventListener("unload",this.beforeUnload)},spliceRootsQuery:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;S.spliceRootsQuery(t)},pushRootToQuery:function(){S.lastNode&&S.pushRootToQuery(S.lastNode)},sortTree:function(t,e){S.sortLastNode(t,e)},addSibling:function(){S.addSibling(),this.focusInput("node-#".concat(S.lastNode._gid))},addChild:function(){S.addChild(),this.focusInput("node-#".concat(S.lastNode._gid))},toggleDone:function(){S.lastNode.toggleDoneState()},shouldDisplayProgress:function(t){var e;return null===t||void 0===t||null===(e=t.settings)||void 0===e?void 0:e.displayProgress},doAllChildren:function(){S.lastNode.setAllChildrenDoneState(!0)},undoAllChildren:function(){S.lastNode.setAllChildrenDoneState(!1)},toggleEmoji:function(t){S.lastNode.toggleEmoji(t)},emojifyArray:function(t){return null!==t&&void 0!==t&&t.length?t.map((function(t){return pt.a.get(t)})):""},setLastNode:function(t,e){var n,i;if(1===(null===e||void 0===e?void 0:e.which)&&S.lastNode._gid===t._gid)return this.collapseLastNode();S.lastNode=t,null===(n=this.$refs)||void 0===n||null===(i=n.contextMenu)||void 0===i||i.close()},editLastNode:function(){S.lastNode.editing=!0,this.focusInput("node-#".concat(S.lastNode._gid))},blurLastNode:function(t){S.blurLastNode(t)},collapseLastNode:function(){S.collapseLastNode()},deleteLastNode:function(){S.deleteLastNode()},quitNodeEditor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{save:!1,callback:null};if(t.shiftKey)return S.lastNode._name+="\n";S.lastNode.firstEdit&&!e.save?S.deleteLastNode({force:!0}):(S.lastNode.editing=!1,S.lastNode.parseName()),"function"===typeof e.callback&&e.callback()},goUp:function(){S.goUp()},goDown:function(){S.goDown()},goLeft:function(){S.goLeft()},goRight:function(){S.goRight()},clickedText:function(t){this.setLastNode(t.data)},clickedNode:function(t){this.setLastNode(t),S.collapseLastNode()},focusInput:function(t){var e=this;t&&this.$nextTick((function(){var n=e.$refs[t];n&&n[0]&&n[0].focus()}))},saveDocument:function(){this.saveDocumentAction(S.export())},handleZoom:function(t){if(2===t.which)return this.restoreScale();t.which||(((t.deltaY||-t.wheelDelta||t.detail)>>10||1)<0?this.zoomIn():this.zoomOut())},init:function(){this.draw(),this.enableDrag(),this.initTransform()},zoomIn:function(){var t,e,n=null===(t=this.$refs.domContainer)||void 0===t||null===(e=t.style)||void 0===e?void 0:e.transform;if(n){var i=1.2,o=n.match(_e);if(o&&o.length>0){var r=parseFloat(o[1]);i*=r}this.setScale(i)}},zoomOut:function(){var t,e,n=null===(t=this.$refs.domContainer)||void 0===t||null===(e=t.style)||void 0===e?void 0:e.transform;if(n){var i=1/1.2,o=n.match(_e);if(o&&o.length>0){var r=parseFloat(o[1]);i=r/1.2}this.setScale(i)}},restoreScale:function(){this.setScale(1)},setScale:function(t){var e,n;if("number"===typeof t){var i=this.getTranslate();if(i){var o="translate(".concat(i[0],"px, ").concat(i[1],"px)");null!==(e=this.$refs.domContainer)&&void 0!==e&&null!==(n=e.style)&&void 0!==n&&n.transform&&(this.$refs.svg.style.transform="scale(".concat(t,") ")+o,this.$refs.domContainer.style.transform="scale(".concat(t,") ")+o,this.currentScale=t)}}},getTranslate:function(){var t,e=null===(t=this.$refs.svg)||void 0===t?void 0:t.style.transform;if(e){var n=e.match(ye);if(null===n)return[null,null];var i=parseInt(n[1]),o=parseInt(n[2]);return[i,o]}},addUniqueKey:function(t){var e=[t];while(0!==e.length){var n=e.pop();n._key=De(),n.children&&e.push.apply(e,Object(d["a"])(n.children))}return t},initTransform:function(){var t=this.$refs.container.offsetHeight;this.initTransformX=Math.floor(this.config.nodeWidth),this.initTransformY=Math.floor(t/2)},generateLinkPath:function(t){if(this.linkStyle===ke.CURVE){var e=ve["linkHorizontal"]();return e.x((function(t){return t.x})).y((function(t){return t.y})).source((function(t){var e={x:t.source.x,y:t.source.y};return je(e)})).target((function(t){var e={x:t.target.x,y:t.target.y};return je(e)})),e(t)}if(this.linkStyle===ke.STRAIGHT){var n=ve["path"](),i={x:t.source.x,y:t.source.y},o={x:t.target.x,y:t.target.y};i=je(i),o=je(o);var r=o.x-i.x,a={x:i.x+r/2,y:i.y},s={x:i.x+r/2,y:o.y};return n.moveTo(i.x,i.y),n.lineTo(a.x,a.y),n.lineTo(s.x,s.y),n.lineTo(o.x,o.y),n.toString()}},draw:function(){var t=this.buildTree(this.tree.root),e=Object(c["a"])(t,2),n=e[0],i=e[1];this.linkDataList=i,this.svg=this.d3.select(this.$refs.svg);var o=this,r=this.svg.selectAll(".link").data(i,(function(t){return"".concat(t.source.data._key,"-").concat(t.target.data._key)}));r.enter().append("path").attr("class","link").attr("d",(function(t){return o.generateLinkPath(t)})),r.transition().duration(we).ease(ve["easeCubicInOut"]).attr("d",(function(t){return o.generateLinkPath(t)})),r.exit().transition().duration(we/2).ease(ve["easeCubicInOut"]).style("opacity",0).remove(),this.nodeDataList=n},buildTree:function(t){var e=this.d3.tree().nodeSize([this.config.nodeWidth,this.config.levelHeight]),n=e(this.d3.hierarchy(t));return be(n),[n.descendants(),n.links()]},enableDrag:function(){var t=this,e=this.$refs.svg,n=this.$refs.container,i=0,o=0,r=!1,a="";n.onmousedown=function(t){a=e.style.transform,i=t.clientX,o=t.clientY,r=!0},n.onmousemove=function(n){if(r){var s=a,d=0,l=0;if(s){var u=s.match(ye);if(null!==u&&0!==u.length){var h=u.slice(1),f=Object(c["a"])(h,2),p=f[0],g=f[1];d=parseInt(p),l=parseInt(g)}}var v=Math.floor((n.clientX-i)/t.currentScale)+d,m=Math.floor((n.clientY-o)/t.currentScale)+l,b="translate(".concat(v,"px, ").concat(m,"px)");s&&(b=s.replace(ye,b)),e.style.transform=b,t.$refs.domContainer.style.transform=b}},n.onmouseleave=function(){i=0,o=0,r=!1},n.onmouseup=function(){i=0,o=0,r=!1}},formatDimension:function(t){return"number"===typeof t?"".concat(t,"px"):-1!==t.indexOf("px")?t:"".concat(t,"px")},parseDimensionNumber:function(t){return"number"===typeof t?t:parseInt(t.replace("px",""))},nodeContextClick:function(t,e){var n;t.preventDefault(),this.setLastNode(e),null===(n=this.$refs.contextMenu)||void 0===n||n.open(t)}}),watch:{"tree.root":{deep:!0,immediate:!0,handler:function(){this.draw(),this.saveDocument()}}}},Oe=Te,Ee=(n("c75b"),n("31f4"),n("18e3"),Object(L["a"])(Oe,a,s,!1,null,"0f436fd6",null)),Se=Ee.exports,Ie={name:"App",components:{Tree:Se},data:function(){return{tree:S}}},Pe=Ie,Ae=(n("034f"),Object(L["a"])(Pe,o,r,!1,null,null,null)),$e=Ae.exports,Le=n("1881"),Fe=n.n(Le),Ge=n("b1e0"),Re=n("dbbe"),Me=n("a166");n("f9e3"),n("2dd8");bt(),i["default"].use(Fe.a,{componentName:"Modal"}),i["default"].use(Ge["a"]),i["default"].use(Re["a"]),i["default"].use(Me["a"]),i["default"].config.productionTip=!1,new i["default"]({render:function(t){return t($e)},store:D}).$mount("#app")},"5cf6":function(t,e,n){"use strict";n("5f8b")},"5f8b":function(t,e,n){},"5f94":function(t,e,n){"use strict";n("160f")},"60d0":function(t,e,n){},"638b":function(t,e,n){"use strict";n("3f89")},"716f":function(t,e,n){"use strict";n("da09")},"7dbe":function(t,e,n){},"85ec":function(t,e,n){},8748:function(t,e,n){},"8adb":function(t,e,n){},"8fc8":function(t,e,n){},"9ddc":function(t,e,n){},ad75:function(t,e,n){"use strict";n("1972")},b7a8:function(t,e,n){},c1c1:function(t,e,n){"use strict";n("9ddc")},c75b:function(t,e,n){"use strict";n("8adb")},d3d5:function(t,e,n){"use strict";n("e01c")},d92b:function(t,e,n){"use strict";n("60d0")},da09:function(t,e,n){},e01c:function(t,e,n){},ec80:function(t,e,n){"use strict";n("7dbe")},f69a:function(t,e,n){},f7ae:function(t,e,n){"use strict";n("15fc")},fe2f:function(t,e,n){}});
//# sourceMappingURL=app.8b7655f1.js.map